<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradeFi</title>
    <style>
        .share {
            text-align: center;
        }
    </style>
</head>

<body>
    <button style="text-align: center; padding: 2%; background-color: aqua;" id="refreshButton">Refresh</button>
    <button style="text-align: center; padding: 2%; background-color: aqua;"><a
            style="text-decoration: none; color: black;" href="/">Stocks</a></button>
            <button style="text-align: center; padding: 2%; background-color: aqua;" ><a style="text-decoration: none; color: black;" href="/backtest">Back Test</a></button>
    <div id="dataContainer"></div>


    <script>
        const symbol_token_dict = {
  "NUVAMA28AUG25FUT": "52475",
    "AMBER28AUG25FUT": "53028",
    "FINNIFTY28AUG25FUT": "64101",
    "ABCAPITAL28AUG25FUT": "64106",
    "ATGL28AUG25FUT": "64120",
    "BAJFINANCE28AUG25FUT": "64220",
    "BDL28AUG25FUT": "64226",
    "BRITANNIA28AUG25FUT": "64373",
    "BSE28AUG25FUT": "64378",
    "DABUR28AUG25FUT": "64397",
    "DELHIVERY28AUG25FUT": "64399",
    "DIVISLAB28AUG25FUT": "64400",
    "DRREDDY28AUG25FUT": "64404",
    "FEDERALBNK28AUG25FUT": "64410",
    "HCLTECH28AUG25FUT": "64423",
    "HINDPETRO28AUG25FUT": "64430",
    "INDHOTEL28AUG25FUT": "64442",
    "INDIANB28AUG25FUT": "64443",
    "JINDALSTEL28AUG25FUT": "64616",
    "MCX28AUG25FUT": "64938",
    "MOTHERSON28AUG25FUT": "64942",
    "PHOENIXLTD28AUG25FUT": "64976",
    "PNB28AUG25FUT": "64979",
    "RECLTD28AUG25FUT": "64994",
    "SIEMENS28AUG25FUT": "65125",
    "SRF28AUG25FUT": "65197",
    "TATAELXSI28AUG25FUT": "65212",
    "TATAPOWER28AUG25FUT": "65217",
    "TIINDIA28AUG25FUT": "65224",
    "TORNTPOWER28AUG25FUT": "65228",
    "ULTRACEMCO28AUG25FUT": "65233",
    "SUZLON28AUG25FUT": "52523",
    "PGEL28AUG25FUT": "53764",
    "BANKNIFTY28AUG25FUT": "64100",
    "NIFTY28AUG25FUT": "64103",
    "ADANIPORTS28AUG25FUT": "64111",
    "APOLLOHOSP28AUG25FUT": "64116",
    "ASIANPAINT28AUG25FUT": "64118",
    "AUBANK28AUG25FUT": "64121",
    "AUROPHARMA28AUG25FUT": "64206",
    "BANDHANBNK28AUG25FUT": "64221",
    "BHEL28AUG25FUT": "64230",
    "BPCL28AUG25FUT": "64372",
    "CANBK28AUG25FUT": "64380",
    "COFORGE28AUG25FUT": "64391",
    "CROMPTON28AUG25FUT": "64394",
    "FORTIS28AUG25FUT": "64413",
    "HEROMOTOCO28AUG25FUT": "64427",
    "IDFCFIRSTB28AUG25FUT": "64438",
    "IIFL28AUG25FUT": "64441",
    "INOXWIND28AUG25FUT": "64456",
    "JSWENERGY28AUG25FUT": "64619",
    "MPHASIS28AUG25FUT": "64943",
    "NYKAA28AUG25FUT": "64963",
    "OFSS28AUG25FUT": "64965",
    "OIL28AUG25FUT": "64968",
    "PIDILITIND28AUG25FUT": "64977",
    "POONAWALLA28AUG25FUT": "64985",
    "SHREECEM28AUG25FUT": "65037",
    "SHRIRAMFIN28AUG25FUT": "65124",
    "UPL28AUG25FUT": "65243",
    "ZYDUSLIFE28AUG25FUT": "65251",
    "ANGELONE28AUG25FUT": "64114",
    "CYIENT28AUG25FUT": "64396",
    "ETERNAL28AUG25FUT": "64407",
    "GRASIM28AUG25FUT": "64420",
    "HDFCLIFE28AUG25FUT": "64426",
    "HINDUNILVR28AUG25FUT": "64431",
    "ICICIBANK28AUG25FUT": "64434",
    "IRFC28AUG25FUT": "64614",
    "KALYANKJIL28AUG25FUT": "64622",
    "LODHA28AUG25FUT": "64632",
    "LTF28AUG25FUT": "64634",
    "LTIM28AUG25FUT": "64635",
    "MANAPPURAM28AUG25FUT": "64897",
    "MARICO28AUG25FUT": "64903",
    "PRESTIGE28AUG25FUT": "64990",
    "SBILIFE28AUG25FUT": "65035",
    "SBIN28AUG25FUT": "65036",
    "SUPREMEIND28AUG25FUT": "65203",
    "TATASTEEL28AUG25FUT": "65218",
    "TITAGARH28AUG25FUT": "65225",
    "TITAN28AUG25FUT": "65226",
    "MIDCPNIFTY28AUG25FUT": "64102",
    "ABB28AUG25FUT": "64105",
    "ALKEM28AUG25FUT": "64112",
    "BANKBARODA28AUG25FUT": "64222",
    "BEL28AUG25FUT": "64227",
    "BIOCON28AUG25FUT": "64231",
    "DIXON28AUG25FUT": "64401",
    "DMART28AUG25FUT": "64403",
    "EICHERMOT28AUG25FUT": "64405",
    "HAVELLS28AUG25FUT": "64422",
    "HUDCO28AUG25FUT": "64433",
    "ITC28AUG25FUT": "64615",
    "MANKIND28AUG25FUT": "64902",
    "MUTHOOTFIN28AUG25FUT": "64944",
    "POLYCAB28AUG25FUT": "64984",
    "RELIANCE28AUG25FUT": "64995",
    "RVNL28AUG25FUT": "64998",
    "TATACHEM28AUG25FUT": "65207",
    "TCS28AUG25FUT": "65222",
    "VBL28AUG25FUT": "65244",
    "YESBANK28AUG25FUT": "65250",
    "NIFTYNXT5028AUG25FUT": "64104",
    "BANKINDIA28AUG25FUT": "64223",
    "CESC28AUG25FUT": "64382",
    "CIPLA28AUG25FUT": "64388",
    "COALINDIA28AUG25FUT": "64390",
    "CONCOR28AUG25FUT": "64393",
    "HINDALCO28AUG25FUT": "64429",
    "ICICIPRULI28AUG25FUT": "64436",
    "IEX28AUG25FUT": "64439",
    "IGL28AUG25FUT": "64440",
    "INDIGO28AUG25FUT": "64451",
    "INFY28AUG25FUT": "64454",
    "IRCTC28AUG25FUT": "64548",
    "JSWSTEEL28AUG25FUT": "64620",
    "KAYNES28AUG25FUT": "64625",
    "LICHSGFIN28AUG25FUT": "64630",
    "M&M28AUG25FUT": "64637",
    "MAZDOCK28AUG25FUT": "64908",
    "OBEROIRLTY28AUG25FUT": "64964",
    "PAYTM28AUG25FUT": "64972",
    "PETRONET28AUG25FUT": "64974",
    "PPLPHARMA28AUG25FUT": "64989",
    "TATATECH28AUG25FUT": "65221",
    "TECHM28AUG25FUT": "65223",
    "TVSMOTOR28AUG25FUT": "65232",
    "VOLTAS28AUG25FUT": "65248",
    "ABFRL28AUG25FUT": "64107",
    "ADANIENT28AUG25FUT": "64109",
    "ASHOKLEY28AUG25FUT": "64117",
    "ASTRAL28AUG25FUT": "64119",
    "BAJAJ-AUTO28AUG25FUT": "64217",
    "BAJAJFINSV28AUG25FUT": "64219",
    "CDSL28AUG25FUT": "64381",
    "CUMMINSIND28AUG25FUT": "64395",
    "HAL28AUG25FUT": "64421",
    "HDFCBANK28AUG25FUT": "64425",
    "HINDZINC28AUG25FUT": "64432",
    "ICICIGI28AUG25FUT": "64435",
    "IDEA28AUG25FUT": "64437",
    "INDUSINDBK28AUG25FUT": "64452",
    "IOC28AUG25FUT": "64457",
    "IREDA28AUG25FUT": "64613",
    "JIOFIN28AUG25FUT": "64617",
    "MAXHEALTH28AUG25FUT": "64905",
    "NATIONALUM28AUG25FUT": "64949",
    "NHPC28AUG25FUT": "64954",
    "PATANJALI28AUG25FUT": "64971",
    "PFC28AUG25FUT": "64975",
    "PIIND28AUG25FUT": "64978",
    "TORNTPHARM28AUG25FUT": "65227",
    "UNIONBANK28AUG25FUT": "65234",
    "VEDL28AUG25FUT": "65245",
    "WIPRO28AUG25FUT": "65249",
    "KFINTECH28AUG25FUT": "53287",
    "ADANIGREEN28AUG25FUT": "64110",
    "AMBUJACEM28AUG25FUT": "64113",
    "BHARTIARTL28AUG25FUT": "64229",
    "BOSCHLTD28AUG25FUT": "64249",
    "CHOLAFIN28AUG25FUT": "64387",
    "DLF28AUG25FUT": "64402",
    "EXIDEIND28AUG25FUT": "64409",
    "GAIL28AUG25FUT": "64414",
    "GMRAIRPORT28AUG25FUT": "64416",
    "GODREJCP28AUG25FUT": "64417",
    "HDFCAMC28AUG25FUT": "64424",
    "IRB28AUG25FUT": "64547",
    "JUBLFOOD28AUG25FUT": "64621",
    "LICI28AUG25FUT": "64631",
    "LT28AUG25FUT": "64633",
    "LUPIN28AUG25FUT": "64636",
    "MFSL28AUG25FUT": "64939",
    "ONGC28AUG25FUT": "64969",
    "RBLBANK28AUG25FUT": "64991",
    "SBICARD28AUG25FUT": "65034",
    "360ONE28AUG25FUT": "53004",
    "ADANIENSOL28AUG25FUT": "64108",
    "CAMS28AUG25FUT": "64379",
    "COLPAL28AUG25FUT": "64392",
    "DALBHARAT28AUG25FUT": "64398",
    "HFCL28AUG25FUT": "64428",
    "INDUSTOWER28AUG25FUT": "64453",
    "JSL28AUG25FUT": "64618",
    "LAURUSLABS28AUG25FUT": "64629",
    "NAUKRI28AUG25FUT": "64950",
    "NBCC28AUG25FUT": "64951",
    "NMDC28AUG25FUT": "64959",
    "NTPC28AUG25FUT": "64962",
    "PAGEIND28AUG25FUT": "64970",
    "PNBHOUSING28AUG25FUT": "64981",
    "POWERGRID28AUG25FUT": "64986",
    "SOLARINDS28AUG25FUT": "65177",
    "SUNPHARMA28AUG25FUT": "65198",
    "TRENT28AUG25FUT": "65231",
    "SJVN28AUG25FUT": "65176",
    "SYNGENE28AUG25FUT": "65206",
    "UNITDSPR28AUG25FUT": "65235",
    "APLAPOLLO28AUG25FUT": "64115",
    "AXISBANK28AUG25FUT": "64207",
    "BHARATFORG28AUG25FUT": "64228",
    "BLUESTARCO28AUG25FUT": "64248",
    "CGPOWER28AUG25FUT": "64383",
    "GLENMARK28AUG25FUT": "64415",
    "GODREJPROP28AUG25FUT": "64418",
    "GRANULES28AUG25FUT": "64419",
    "KEI28AUG25FUT": "64626",
    "KOTAKBANK28AUG25FUT": "64627",
    "KPITTECH28AUG25FUT": "64628",
    "MARUTI28AUG25FUT": "64904",
    "NCC28AUG25FUT": "64952",
    "NESTLEIND28AUG25FUT": "64953",
    "PERSISTENT28AUG25FUT": "64973",
    "POLICYBZR28AUG25FUT": "64982",
    "SAIL28AUG25FUT": "64999",
    "SONACOMS28AUG25FUT": "65196",
    "TATACONSUM28AUG25FUT": "65208",
    "TATAMOTORS28AUG25FUT": "65213",
    "UNOMINDA28AUG25FUT": "65242",
    "NATURALGAS26AUG25FUT": "450499",
    "MENTHAOIL29AUG25FUT": "450656",
    "COPPER29AUG25FUT": "452845",
    "STEELREBAR29AUG25FUT": "452847",
    "ALUMINI29AUG25FUT": "452849",
    "ZINC29AUG25FUT": "452852",
    "SILVERMIC29AUG25FUT": "444542",
    "NICKEL29AUG25FUT": "452850",
    "LEAD29AUG25FUT": "452851",
    "ZINCMINI29AUG25FUT": "452853",
    "GOLDM05AUG25FUT": "457105",
    "MCXMETLDEX22AUG25FUT": "457511",
    "MCXBULLDEX27AUG25FUT": "457885",
    "GOLDGUINEA29AUG25FUT": "456966",
    "COTTONOIL29AUG25FUT": "456969",
    "ELECDMBL29AUG25FUT": "463396",
    "GOLD05AUG25FUT": "438425",
    "NATGASMINI26AUG25FUT": "450500",
    "ALUMINIUM29AUG25FUT": "452848",
    "SILVERM29AUG25FUT": "439487",
    "CRUDEOIL19AUG25FUT": "450134",
    "CRUDEOILM19AUG25FUT": "450135",
    "LEADMINI29AUG25FUT": "452846",
    "GOLDTEN29AUG25FUT": "458304",
    "GOLDPETAL29AUG25FUT": "456967",
            "THIS IS LAST >>>>>>REFRESH__AGAIN>>>>>> CARDAMOM29AUG25FUT": "465831"
        };

        async function fetchCandleDataSequential(tokens) {
            for (let token of tokens) {
                const tokenName = Object.keys(symbol_token_dict).find(key  => symbol_token_dict[key] === token).replace(/-EQ$/, '');
                try {
                    const response = await fetch(`/get_fut_data/${token}/${tokenName}`);
                    const data = await response.json();
                    displayData(token, data);
                } catch (error) {
                    console.error(`Error fetching data for token ${token}:`, error);
                }
            }
        }

        function displayData(token, data) {
            const dataContainer = document.getElementById('dataContainer');

            const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token);
            const today_len = data.data.length - 1;
            const yesterday_len = data.data.length - 2;
            const todayHigh = parseFloat(data.data[today_len]['2']);
            const todayLow = parseFloat(data.data[today_len]['3']);
            const yesterdayHigh = parseFloat(data.data[yesterday_len]['2']);
            const yesterdayLow = parseFloat(data.data[yesterday_len]['3']);
            const todayVol = parseFloat(data.data[today_len]['5']);
            const yesterdayVol = parseFloat(data.data[yesterday_len]['5']);

            const div = document.createElement('div');
            div.innerHTML = ` <br> <p class='share' > <b>${tokenName}:</b> ${JSON.stringify(data.data[today_len]['4'])}</p>
            <p class='share' > <b>Today:</b>  High: ${todayHigh} -- Low: ${todayLow} -- Volume: ${todayVol} </p>
            <p class='share' > <b>Yesterday:</b>  High: ${yesterdayHigh} -- Low: ${yesterdayLow} -- Volume: ${yesterdayVol} </p>
            <hr>`;



            if (todayHigh > yesterdayHigh && todayLow < yesterdayLow) {
                div.style.color = 'green';
                div.style.backgroundColor = 'chartreuse';
            } else {
                div.style.color = 'black';
            }


            if (dataContainer.firstChild) {
                dataContainer.insertBefore(div, dataContainer.firstChild);
            } else {
                dataContainer.appendChild(div);
            }
        }

        const tokens = Object.values(symbol_token_dict);
        console.log(tokens)

        fetchCandleDataSequential(tokens);

        function refreshData() {
            const dataContainer = document.getElementById('dataContainer');
            dataContainer.innerHTML = '';
            fetchCandleDataSequential(tokens);
        }
        document.getElementById('refreshButton').addEventListener('click', refreshData);
    </script>

</body>

</html>
