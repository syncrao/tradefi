<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradeFi</title>
    <style>
        .share {
            text-align: center;
        }
    </style>
</head>

<body>
    <button style="text-align: center; padding: 2%; background-color: aqua;" id="refreshButton">Refresh</button>
    <button style="text-align: center; padding: 2%; background-color: aqua;"><a
            style="text-decoration: none; color: black;" href="/">Stocks</a></button>
            <button style="text-align: center; padding: 2%; background-color: aqua;" ><a style="text-decoration: none; color: black;" href="/backtest">Back Test</a></button>
    <div id="dataContainer"></div>


    <script>
        const symbol_token_dict = {
     "NIFTY30DEC25FUT": "49543",
    "ADANIENSOL30DEC25FUT": "49562",
    "ASHOKLEY30DEC25FUT": "49588",
    "AUBANK30DEC25FUT": "49591",
    "AXISBANK30DEC25FUT": "49598",
    "BOSCHLTD30DEC25FUT": "49639",
    "CAMS30DEC25FUT": "49651",
    "EICHERMOT30DEC25FUT": "49711",
    "EXIDEIND30DEC25FUT": "49713",
    "ICICIGI30DEC25FUT": "49813",
    "INFY30DEC25FUT": "49840",
    "JINDALSTEL30DEC25FUT": "49859",
    "KEI30DEC25FUT": "49870",
    "KFINTECH30DEC25FUT": "49871",
    "LICHSGFIN30DEC25FUT": "49912",
    "MFSL30DEC25FUT": "49931",
    "NAUKRI30DEC25FUT": "49938",
    "OBEROIRLTY30DEC25FUT": "49950",
    "ONGC30DEC25FUT": "49954",
    "POWERINDIA30DEC25FUT": "50000",
    "SUNPHARMA30DEC25FUT": "50084",
    "SUZLON30DEC25FUT": "50103",
    "SYNGENE30DEC25FUT": "50104",
    "TORNTPOWER30DEC25FUT": "50147",
    "TVSMOTOR30DEC25FUT": "50149",
    "360ONE30DEC25FUT": "49545",
    "ABCAPITAL30DEC25FUT": "49557",
    "ANGELONE30DEC25FUT": "49581",
    "APLAPOLLO30DEC25FUT": "49583",
    "APOLLOHOSP30DEC25FUT": "49584",
    "AUROPHARMA30DEC25FUT": "49597",
    "CDSL30DEC25FUT": "49657",
    "CUMMINSIND30DEC25FUT": "49680",
    "DMART30DEC25FUT": "49700",
    "GODREJPROP30DEC25FUT": "49729",
    "HEROMOTOCO30DEC25FUT": "49773",
    "HINDPETRO30DEC25FUT": "49804",
    "KALYANKJIL30DEC25FUT": "49866",
    "INDUSTOWER30DEC25FUT": "49837",
    "JSWSTEEL30DEC25FUT": "49862",
    "LUPIN30DEC25FUT": "49920",
    "M&M30DEC25FUT": "49921",
    "MCX30DEC25FUT": "49930",
    "PFC30DEC25FUT": "49962",
    "PIIND30DEC25FUT": "49966",
    "POLYCAB30DEC25FUT": "49972",
    "SHREECEM30DEC25FUT": "50068",
    "SIEMENS30DEC25FUT": "50076",
    "TMPV30DEC25FUT": "50115",
    "TCS30DEC25FUT": "50124",
    "VBL30DEC25FUT": "50170",
    "VEDL30DEC25FUT": "50171",
    "YESBANK30DEC25FUT": "50178",
    "FINNIFTY30DEC25FUT": "49521",
    "MIDCPNIFTY30DEC25FUT": "49522",
    "NIFTYNXT5030DEC25FUT": "49544",
    "ABB30DEC25FUT": "49548",
    "BAJAJFINSV30DEC25FUT": "49611",
    "BANKBARODA30DEC25FUT": "49616",
    "BSE30DEC25FUT": "49650",
    "COALINDIA30DEC25FUT": "49664",
    "COLPAL30DEC25FUT": "49674",
    "CONCOR30DEC25FUT": "49675",
    "DRREDDY30DEC25FUT": "49707",
    "HINDZINC30DEC25FUT": "49809",
    "HUDCO30DEC25FUT": "49810",
    "IREDA30DEC25FUT": "49852",
    "IRFC30DEC25FUT": "49853",
    "ITC30DEC25FUT": "49858",
    "MANAPPURAM30DEC25FUT": "49922",
    "NESTLEIND30DEC25FUT": "49943",
    "NTPC30DEC25FUT": "49946",
    "OFSS30DEC25FUT": "49951",
    "PRESTIGE30DEC25FUT": "50006",
    "RECLTD30DEC25FUT": "50013",
    "RVNL30DEC25FUT": "50015",
    "SAIL30DEC25FUT": "50016",
    "SHRIRAMFIN30DEC25FUT": "50069",
    "TATAELXSI30DEC25FUT": "50110",
    "ADANIGREEN30DEC25FUT": "49566",
    "ADANIPORTS30DEC25FUT": "49569",
    "AMBUJACEM30DEC25FUT": "49580",
    "BEL30DEC25FUT": "49625",
    "BHARATFORG30DEC25FUT": "49626",
    "CGPOWER30DEC25FUT": "49661",
    "CHOLAFIN30DEC25FUT": "49662",
    "DABUR30DEC25FUT": "49688",
    "DALBHARAT30DEC25FUT": "49691",
    "DLF30DEC25FUT": "49699",
    "GODREJCP30DEC25FUT": "49728",
    "FORTIS30DEC25FUT": "49723",
    "GLENMARK30DEC25FUT": "49725",
    "HDFCAMC30DEC25FUT": "49744",
    "ICICIPRULI30DEC25FUT": "49814",
    "IRCTC30DEC25FUT": "49851",
    "JSWENERGY30DEC25FUT": "49861",
    "MARUTI30DEC25FUT": "49927",
    "LICI30DEC25FUT": "49913",
    "LT30DEC25FUT": "49915",
    "MAXHEALTH30DEC25FUT": "49928",
    "MUTHOOTFIN30DEC25FUT": "49936",
    "NCC30DEC25FUT": "49942",
    "PAGEIND30DEC25FUT": "49955",
    "PNBHOUSING30DEC25FUT": "49970",
    "POWERGRID30DEC25FUT": "49973",
    "SBICARD30DEC25FUT": "50064",
    "SUPREMEIND30DEC25FUT": "50085",
    "TATASTEEL30DEC25FUT": "50120",
    "TITAN30DEC25FUT": "50140",
    "UNIONBANK30DEC25FUT": "50166",
    "ZYDUSLIFE30DEC25FUT": "50179",
    "ASTRAL30DEC25FUT": "49590",
    "BHARTIARTL30DEC25FUT": "49629",
    "BLUESTARCO30DEC25FUT": "49638",
    "COFORGE30DEC25FUT": "49673",
    "CROMPTON30DEC25FUT": "49676",
    "DIXON30DEC25FUT": "49696",
    "GMRAIRPORT30DEC25FUT": "49726",
    "HINDALCO30DEC25FUT": "49803",
    "INDIANB30DEC25FUT": "49828",
    "JUBLFOOD30DEC25FUT": "49863",
    "NUVAMA30DEC25FUT": "49948",
    "TECHM30DEC25FUT": "50125",
    "TORNTPHARM30DEC25FUT": "50144",
    "TRENT30DEC25FUT": "50148",
    "UNITDSPR30DEC25FUT": "50167",
    "BHEL30DEC25FUT": "49633",
    "CYIENT30DEC25FUT": "49687",
    "HAL30DEC25FUT": "49741",
    "IDEA30DEC25FUT": "49817",
    "IEX30DEC25FUT": "49825",
    "IOC30DEC25FUT": "49850",
    "MAZDOCK30DEC25FUT": "49929",
    "PIDILITIND30DEC25FUT": "49965",
    "SOLARINDS30DEC25FUT": "50077",
    "ADANIENT30DEC25FUT": "49563",
    "BAJAJ-AUTO30DEC25FUT": "49602",
    "BAJFINANCE30DEC25FUT": "49612",
    "BDL30DEC25FUT": "49624",
    "CANBK30DEC25FUT": "49652",
    "CIPLA30DEC25FUT": "49663",
    "DELHIVERY30DEC25FUT": "49692",
    "ETERNAL30DEC25FUT": "49712",
    "FEDERALBNK30DEC25FUT": "49714",
    "GAIL30DEC25FUT": "49724",
    "HAVELLS30DEC25FUT": "49742",
    "IIFL30DEC25FUT": "49826",
    "KAYNES30DEC25FUT": "49867",
    "MANKIND30DEC25FUT": "49923",
    "LODHA30DEC25FUT": "49914",
    "LTIM30DEC25FUT": "49919",
    "MARICO30DEC25FUT": "49924",
    "NMDC30DEC25FUT": "49945",
    "NYKAA30DEC25FUT": "49949",
    "OIL30DEC25FUT": "49953",
    "PERSISTENT30DEC25FUT": "49960",
    "PGEL30DEC25FUT": "49963",
    "POLICYBZR30DEC25FUT": "49971",
    "RBLBANK30DEC25FUT": "50008",
    "SBIN30DEC25FUT": "50066",
    "SONACOMS30DEC25FUT": "50078",
    "TATACONSUM30DEC25FUT": "50109",
    "TITAGARH30DEC25FUT": "50130",
    "ULTRACEMCO30DEC25FUT": "50150",
    "UPL30DEC25FUT": "50169",
    "BANKNIFTY30DEC25FUT": "49508",
    "ALKEM30DEC25FUT": "49571",
    "ASIANPAINT30DEC25FUT": "49589",
    "BANDHANBNK30DEC25FUT": "49613",
    "BANKINDIA30DEC25FUT": "49621",
    "BIOCON30DEC25FUT": "49634",
    "BPCL30DEC25FUT": "49644",
    "DIVISLAB30DEC25FUT": "49693",
    "HDFCBANK30DEC25FUT": "49759",
    "HFCL30DEC25FUT": "49776",
    "HDFCLIFE30DEC25FUT": "49760",
    "IDFCFIRSTB30DEC25FUT": "49822",
    "INDUSINDBK30DEC25FUT": "49830",
    "JIOFIN30DEC25FUT": "49860",
    "KOTAKBANK30DEC25FUT": "49872",
    "KPITTECH30DEC25FUT": "49910",
    "LAURUSLABS30DEC25FUT": "49911",
    "LTF30DEC25FUT": "49916",
    "NATIONALUM30DEC25FUT": "49937",
    "NHPC30DEC25FUT": "49944",
    "PATANJALI30DEC25FUT": "49956",
    "PAYTM30DEC25FUT": "49959",
    "PETRONET30DEC25FUT": "49961",
    "PHOENIXLTD30DEC25FUT": "49964",
    "PNB30DEC25FUT": "49967",
    "PPLPHARMA30DEC25FUT": "50001",
    "SBILIFE30DEC25FUT": "50065",
    "SRF30DEC25FUT": "50079",
    "TATAPOWER30DEC25FUT": "50118",
    "WIPRO30DEC25FUT": "50173",
    "AMBER30DEC25FUT": "49577",
    "BRITANNIA30DEC25FUT": "49647",
    "GRASIM30DEC25FUT": "49730",
    "HCLTECH30DEC25FUT": "49743",
    "HINDUNILVR30DEC25FUT": "49805",
    "ICICIBANK30DEC25FUT": "49812",
    "INDHOTEL30DEC25FUT": "49827",
    "INDIGO30DEC25FUT": "49829",
    "INOXWIND30DEC25FUT": "49849",
    "MOTHERSON30DEC25FUT": "49932",
    "MPHASIS30DEC25FUT": "49933",
    "NBCC30DEC25FUT": "49941",
    "RELIANCE30DEC25FUT": "50014",
    "SAMMAANCAP30DEC25FUT": "50063",
    "TATATECH30DEC25FUT": "50123",
    "TIINDIA30DEC25FUT": "50126",
    "UNOMINDA30DEC25FUT": "50168",
    "VOLTAS30DEC25FUT": "50172",
    "LEADMINI31DEC25FUT": "466017",
    "COTTON31DEC25FUT": "463162",
    "CARDAMOM31DEC25FUT": "466034",
    "STEELREBAR31DEC25FUT": "466019",
    "GOLDGUINEA31DEC25FUT": "467740",
    "GOLDPETAL31DEC25FUT": "467741",
    "MCXMETLDEX23DEC25FUT": "471325",
    "GOLDTEN31DEC25FUT": "472782",
    "GOLD05DEC25FUT": "445003",
    "SILVER05DEC25FUT": "445004",
    "NATURALGAS26DEC25FUT": "463007",
    "NICKEL17DEC25FUT": "466402",
    "ALUMINIUM31DEC25FUT": "466014",
    "LEAD31DEC25FUT": "466016",
    "ZINC31DEC25FUT": "466020",
    "ZINCMINI31DEC25FUT": "466021",
    "CRUDEOIL18DEC25FUT": "462523",
    "CRUDEOILM18DEC25FUT": "462524",
    "NATGASMINI26DEC25FUT": "463008",
    "MENTHAOIL31DEC25FUT": "463268",
    "ALUMINI31DEC25FUT": "466013",
    "COPPER31DEC25FUT": "466015",
    "COTTONOIL31DEC25FUT": "467749",
    "ELECDMBL30DEC25FUT": "467751",
    "GOLDM05DEC25FUT": "470295",
            "THIS IS LAST >>>>>>REFRESH__AGAIN>>>>>> MCXBULLDEX31DEC25FUT": "472791"
        };

        async function fetchCandleDataSequential(tokens) {
            for (let token of tokens) {
                const tokenName = Object.keys(symbol_token_dict).find(key  => symbol_token_dict[key] === token).replace(/-EQ$/, '');
                try {
                    const response = await fetch(`/get_fut_data/${token}/${tokenName}`);
                    const data = await response.json();
                    displayData(token, data);
                } catch (error) {
                    console.error(`Error fetching data for token ${token}:`, error);
                }
            }
        }

        function displayData(token, data) {
            const dataContainer = document.getElementById('dataContainer');

            const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token);
            const today_len = data.data.length - 1;
            const yesterday_len = data.data.length - 2;
            const todayHigh = parseFloat(data.data[today_len]['2']);
            const todayLow = parseFloat(data.data[today_len]['3']);
            const yesterdayHigh = parseFloat(data.data[yesterday_len]['2']);
            const yesterdayLow = parseFloat(data.data[yesterday_len]['3']);
            const todayVol = parseFloat(data.data[today_len]['5']);
            const yesterdayVol = parseFloat(data.data[yesterday_len]['5']);

            const div = document.createElement('div');
            div.innerHTML = ` <br> <p class='share' > <b>${tokenName}:</b> ${JSON.stringify(data.data[today_len]['4'])}</p>
            <p class='share' > <b>Today:</b>  High: ${todayHigh} -- Low: ${todayLow} -- Volume: ${todayVol} </p>
            <p class='share' > <b>Yesterday:</b>  High: ${yesterdayHigh} -- Low: ${yesterdayLow} -- Volume: ${yesterdayVol} </p>
            <hr>`;



            if (todayHigh > yesterdayHigh && todayLow < yesterdayLow) {
                div.style.color = 'green';
                div.style.backgroundColor = 'chartreuse';
            } else {
                div.style.color = 'black';
            }


            if (dataContainer.firstChild) {
                dataContainer.insertBefore(div, dataContainer.firstChild);
            } else {
                dataContainer.appendChild(div);
            }
        }

        const tokens = Object.values(symbol_token_dict);
        console.log(tokens)

        fetchCandleDataSequential(tokens);

        function refreshData() {
            const dataContainer = document.getElementById('dataContainer');
            dataContainer.innerHTML = '';
            fetchCandleDataSequential(tokens);
        }
        document.getElementById('refreshButton').addEventListener('click', refreshData);
    </script>

</body>

</html>
