<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradeFi</title>
    <style>
        .share {
            text-align: center;
        }
    </style>
</head>

<body>
    <button style="text-align: center; padding: 2%; background-color: aqua;" id="refreshButton">Refresh</button>
    <button style="text-align: center; padding: 2%; background-color: aqua;"><a
            style="text-decoration: none; color: black;" href="/">Stocks</a></button>
            <button style="text-align: center; padding: 2%; background-color: aqua;" ><a style="text-decoration: none; color: black;" href="/backtest">Back Test</a></button>
    <div id="dataContainer"></div>


    <script>
        const symbol_token_dict = {
   "MIDCPNIFTY28OCT25FUT": "52147",
    "ABB28OCT25FUT": "52171",
    "ALKEM28OCT25FUT": "52177",
    "AMBUJACEM28OCT25FUT": "52179",
    "APLAPOLLO28OCT25FUT": "52201",
    "BANKBARODA28OCT25FUT": "52256",
    "CDSL28OCT25FUT": "52304",
    "CROMPTON28OCT25FUT": "52314",
    "DRREDDY28OCT25FUT": "52336",
    "ICICIBANK28OCT25FUT": "52374",
    "ICICIGI28OCT25FUT": "52375",
    "IRCTC28OCT25FUT": "52407",
    "ITC28OCT25FUT": "52414",
    "LTF28OCT25FUT": "52443",
    "MARICO28OCT25FUT": "52453",
    "PNB28OCT25FUT": "52500",
    "POWERGRID28OCT25FUT": "52504",
    "PPLPHARMA28OCT25FUT": "52505",
    "VOLTAS28OCT25FUT": "52567",
    "BAJAJFINSV28OCT25FUT": "52240",
    "BHARTIARTL28OCT25FUT": "52276",
    "COLPAL28OCT25FUT": "52310",
    "CUMMINSIND28OCT25FUT": "52315",
    "DABUR28OCT25FUT": "52317",
    "DIVISLAB28OCT25FUT": "52326",
    "DLF28OCT25FUT": "52328",
    "EICHERMOT28OCT25FUT": "52337",
    "EXIDEIND28OCT25FUT": "52339",
    "GMRAIRPORT28OCT25FUT": "52344",
    "HINDZINC28OCT25FUT": "52371",
    "IOC28OCT25FUT": "52406",
    "JSWSTEEL28OCT25FUT": "52422",
    "M&M28OCT25FUT": "52446",
    "MAXHEALTH28OCT25FUT": "52455",
    "MCX28OCT25FUT": "52457",
    "NATIONALUM28OCT25FUT": "52462",
    "NYKAA28OCT25FUT": "52485",
    "PNBHOUSING28OCT25FUT": "52501",
    "PRESTIGE28OCT25FUT": "52506",
    "RELIANCE28OCT25FUT": "52509",
    "SUNPHARMA28OCT25FUT": "52521",
    "TATAELXSI28OCT25FUT": "52531",
    "TITAN28OCT25FUT": "52545",
    "TRENT28OCT25FUT": "52555",
    "UNITDSPR28OCT25FUT": "52560",
    "ZYDUSLIFE28OCT25FUT": "52570",
    "NIFTY28OCT25FUT": "52168",
    "APOLLOHOSP28OCT25FUT": "52214",
    "ASIANPAINT28OCT25FUT": "52216",
    "BAJAJ-AUTO28OCT25FUT": "52224",
    "BIOCON28OCT25FUT": "52288",
    "BRITANNIA28OCT25FUT": "52292",
    "CGPOWER28OCT25FUT": "52305",
    "DELHIVERY28OCT25FUT": "52319",
    "GAIL28OCT25FUT": "52342",
    "HAVELLS28OCT25FUT": "52353",
    "HCLTECH28OCT25FUT": "52362",
    "HDFCBANK28OCT25FUT": "52364",
    "HFCL28OCT25FUT": "52367",
    "HINDUNILVR28OCT25FUT": "52370",
    "IDEA28OCT25FUT": "52379",
    "IDFCFIRSTB28OCT25FUT": "52380",
    "INDHOTEL28OCT25FUT": "52384",
    "INOXWIND28OCT25FUT": "52399",
    "JUBLFOOD28OCT25FUT": "52423",
    "KFINTECH28OCT25FUT": "52429",
    "NBCC28OCT25FUT": "52464",
    "PGEL28OCT25FUT": "52496",
    "POLICYBZR28OCT25FUT": "52502",
    "SAIL28OCT25FUT": "52511",
    "SBILIFE28OCT25FUT": "52513",
    "SBIN28OCT25FUT": "52514",
    "SHRIRAMFIN28OCT25FUT": "52516",
    "SOLARINDS28OCT25FUT": "52518",
    "SUPREMEIND28OCT25FUT": "52522",
    "SUZLON28OCT25FUT": "52525",
    "TATASTEEL28OCT25FUT": "52534",
    "VEDL28OCT25FUT": "52566",
    "FINNIFTY28OCT25FUT": "52146",
    "NIFTYNXT5028OCT25FUT": "52169",
    "BAJFINANCE28OCT25FUT": "52241",
    "CANBK28OCT25FUT": "52303",
    "COALINDIA28OCT25FUT": "52308",
    "FEDERALBNK28OCT25FUT": "52340",
    "HINDALCO28OCT25FUT": "52368",
    "HINDPETRO28OCT25FUT": "52369",
    "INDIANB28OCT25FUT": "52390",
    "INFY28OCT25FUT": "52398",
    "KALYANKJIL28OCT25FUT": "52424",
    "KAYNES28OCT25FUT": "52425",
    "LICI28OCT25FUT": "52434",
    "MFSL28OCT25FUT": "52458",
    "NCC28OCT25FUT": "52465",
    "NHPC28OCT25FUT": "52470",
    "NMDC28OCT25FUT": "52471",
    "NUVAMA28OCT25FUT": "52484",
    "PIDILITIND28OCT25FUT": "52498",
    "RECLTD28OCT25FUT": "52508",
    "SYNGENE28OCT25FUT": "52526",
    "TORNTPOWER28OCT25FUT": "52549",
    "UNIONBANK28OCT25FUT": "52559",
    "YESBANK28OCT25FUT": "52569",
    "SAMMAANCAP28OCT25FUT": "49082",
    "ADANIGREEN28OCT25FUT": "52175",
    "ASTRAL28OCT25FUT": "52217",
    "BOSCHLTD28OCT25FUT": "52290",
    "BSE28OCT25FUT": "52301",
    "CAMS28OCT25FUT": "52302",
    "COFORGE28OCT25FUT": "52309",
    "ETERNAL28OCT25FUT": "52338",
    "GODREJPROP28OCT25FUT": "52350",
    "HAL28OCT25FUT": "52352",
    "IIFL28OCT25FUT": "52383",
    "INDIGO28OCT25FUT": "52391",
    "INDUSINDBK28OCT25FUT": "52394",
    "JINDALSTEL28OCT25FUT": "52415",
    "LTIM28OCT25FUT": "52444",
    "MANAPPURAM28OCT25FUT": "52448",
    "MOTHERSON28OCT25FUT": "52459",
    "NESTLEIND28OCT25FUT": "52466",
    "OBEROIRLTY28OCT25FUT": "52486",
    "OIL28OCT25FUT": "52488",
    "PAYTM28OCT25FUT": "52492",
    "PIIND28OCT25FUT": "52499",
    "SONACOMS28OCT25FUT": "52519",
    "SRF28OCT25FUT": "52520",
    "TATAPOWER28OCT25FUT": "52533",
    "TCS28OCT25FUT": "52539",
    "UNOMINDA28OCT25FUT": "52561",
    "WIPRO28OCT25FUT": "52568",
    "360ONE28OCT25FUT": "52170",
    "ABCAPITAL28OCT25FUT": "52172",
    "AMBER28OCT25FUT": "52178",
    "ASHOKLEY28OCT25FUT": "52215",
    "BDL28OCT25FUT": "52267",
    "BHARATFORG28OCT25FUT": "52275",
    "BHEL28OCT25FUT": "52277",
    "BLUESTARCO28OCT25FUT": "52289",
    "CYIENT28OCT25FUT": "52316",
    "DIXON28OCT25FUT": "52327",
    "FORTIS28OCT25FUT": "52341",
    "HDFCAMC28OCT25FUT": "52363",
    "HDFCLIFE28OCT25FUT": "52365",
    "HEROMOTOCO28OCT25FUT": "52366",
    "ICICIPRULI28OCT25FUT": "52378",
    "IGL28OCT25FUT": "52382",
    "JIOFIN28OCT25FUT": "52418",
    "JSWENERGY28OCT25FUT": "52419",
    "KOTAKBANK28OCT25FUT": "52430",
    "LAURUSLABS28OCT25FUT": "52432",
    "LICHSGFIN28OCT25FUT": "52433",
    "LT28OCT25FUT": "52442",
    "NAUKRI28OCT25FUT": "52463",
    "NTPC28OCT25FUT": "52474",
    "PAGEIND28OCT25FUT": "52490",
    "PATANJALI28OCT25FUT": "52491",
    "PETRONET28OCT25FUT": "52494",
    "PFC28OCT25FUT": "52495",
    "ULTRACEMCO28OCT25FUT": "52558",
    "AUROPHARMA28OCT25FUT": "52219",
    "BEL28OCT25FUT": "52274",
    "GRASIM28OCT25FUT": "52351",
    "HUDCO28OCT25FUT": "52372",
    "IEX28OCT25FUT": "52381",
    "IRFC28OCT25FUT": "52411",
    "KPITTECH28OCT25FUT": "52431",
    "LUPIN28OCT25FUT": "52445",
    "PERSISTENT28OCT25FUT": "52493",
    "POLYCAB28OCT25FUT": "52503",
    "SHREECEM28OCT25FUT": "52515",
    "SIEMENS28OCT25FUT": "52517",
    "TIINDIA28OCT25FUT": "52543",
    "TITAGARH28OCT25FUT": "52544",
    "UPL28OCT25FUT": "52562",
    "VBL28OCT25FUT": "52563",
    "POWERINDIA28OCT25FUT": "49974",
    "BANKNIFTY28OCT25FUT": "52145",
    "ADANIENSOL28OCT25FUT": "52173",
    "ADANIPORTS28OCT25FUT": "52176",
    "AXISBANK28OCT25FUT": "52223",
    "BANKINDIA28OCT25FUT": "52266",
    "CHOLAFIN28OCT25FUT": "52306",
    "CIPLA28OCT25FUT": "52307",
    "GODREJCP28OCT25FUT": "52345",
    "IREDA28OCT25FUT": "52410",
    "KEI28OCT25FUT": "52428",
    "MANKIND28OCT25FUT": "52449",
    "MARUTI28OCT25FUT": "52454",
    "MPHASIS28OCT25FUT": "52460",
    "MUTHOOTFIN28OCT25FUT": "52461",
    "ONGC28OCT25FUT": "52489",
    "RVNL28OCT25FUT": "52510",
    "SBICARD28OCT25FUT": "52512",
    "TATAMOTORS28OCT25FUT": "52532",
    "TVSMOTOR28OCT25FUT": "52556",
    "ADANIENT28OCT25FUT": "52174",
    "ANGELONE28OCT25FUT": "52200",
    "AUBANK28OCT25FUT": "52218",
    "BANDHANBNK28OCT25FUT": "52255",
    "BPCL28OCT25FUT": "52291",
    "CONCOR28OCT25FUT": "52311",
    "DALBHARAT28OCT25FUT": "52318",
    "DMART28OCT25FUT": "52329",
    "GLENMARK28OCT25FUT": "52343",
    "INDUSTOWER28OCT25FUT": "52395",
    "LODHA28OCT25FUT": "52441",
    "MAZDOCK28OCT25FUT": "52456",
    "OFSS28OCT25FUT": "52487",
    "PHOENIXLTD28OCT25FUT": "52497",
    "RBLBANK28OCT25FUT": "52507",
    "TATACONSUM28OCT25FUT": "52527",
    "TATATECH28OCT25FUT": "52538",
    "TECHM28OCT25FUT": "52542",
    "TORNTPHARM28OCT25FUT": "52548",
    "NATGASMINI28OCT25FUT": "456792",
    "CRUDEOIL20OCT25FUT": "455865",
    "ALUMINIUM31OCT25FUT": "458293",
    "ALUMINI31OCT25FUT": "458294",
    "COPPER31OCT25FUT": "458295",
    "ZINCMINI31OCT25FUT": "458301",
    "GOLD03OCT25FUT": "440939",
    "GOLDGUINEA31OCT25FUT": "463265",
    "GOLDM03OCT25FUT": "463393",
    "COTTONOIL31OCT25FUT": "463269",
    "ELECDMBL30OCT25FUT": "463398",
    "MENTHAOIL31OCT25FUT": "457078",
    "NATURALGAS28OCT25FUT": "456791",
    "ZINC31OCT25FUT": "458300",
    "NICKEL15OCT25FUT": "466536",
    "LEAD31OCT25FUT": "458296",
    "CRUDEOILM20OCT25FUT": "455866",
    "LEADMINI31OCT25FUT": "458297",
    "STEELREBAR31OCT25FUT": "458299",
    "MCXMETLDEX24OCT25FUT": "464085",
    "MCXBULLDEX29OCT25FUT": "464824",
    "GOLDTEN31OCT25FUT": "466028",
    "GOLDPETAL31OCT25FUT": "463266",
            "THIS IS LAST >>>>>>REFRESH__AGAIN>>>>>> CARDAMOM31OCT25FUT": "465833"
        };

        async function fetchCandleDataSequential(tokens) {
            for (let token of tokens) {
                const tokenName = Object.keys(symbol_token_dict).find(key  => symbol_token_dict[key] === token).replace(/-EQ$/, '');
                try {
                    const response = await fetch(`/get_fut_data/${token}/${tokenName}`);
                    const data = await response.json();
                    displayData(token, data);
                } catch (error) {
                    console.error(`Error fetching data for token ${token}:`, error);
                }
            }
        }

        function displayData(token, data) {
            const dataContainer = document.getElementById('dataContainer');

            const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token);
            const today_len = data.data.length - 1;
            const yesterday_len = data.data.length - 2;
            const todayHigh = parseFloat(data.data[today_len]['2']);
            const todayLow = parseFloat(data.data[today_len]['3']);
            const yesterdayHigh = parseFloat(data.data[yesterday_len]['2']);
            const yesterdayLow = parseFloat(data.data[yesterday_len]['3']);
            const todayVol = parseFloat(data.data[today_len]['5']);
            const yesterdayVol = parseFloat(data.data[yesterday_len]['5']);

            const div = document.createElement('div');
            div.innerHTML = ` <br> <p class='share' > <b>${tokenName}:</b> ${JSON.stringify(data.data[today_len]['4'])}</p>
            <p class='share' > <b>Today:</b>  High: ${todayHigh} -- Low: ${todayLow} -- Volume: ${todayVol} </p>
            <p class='share' > <b>Yesterday:</b>  High: ${yesterdayHigh} -- Low: ${yesterdayLow} -- Volume: ${yesterdayVol} </p>
            <hr>`;



            if (todayHigh > yesterdayHigh && todayLow < yesterdayLow) {
                div.style.color = 'green';
                div.style.backgroundColor = 'chartreuse';
            } else {
                div.style.color = 'black';
            }


            if (dataContainer.firstChild) {
                dataContainer.insertBefore(div, dataContainer.firstChild);
            } else {
                dataContainer.appendChild(div);
            }
        }

        const tokens = Object.values(symbol_token_dict);
        console.log(tokens)

        fetchCandleDataSequential(tokens);

        function refreshData() {
            const dataContainer = document.getElementById('dataContainer');
            dataContainer.innerHTML = '';
            fetchCandleDataSequential(tokens);
        }
        document.getElementById('refreshButton').addEventListener('click', refreshData);
    </script>

</body>

</html>
