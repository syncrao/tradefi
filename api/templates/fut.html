<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradeFi</title>
    <style>
        .share {
            text-align: center;
        }
    </style>
</head>

<body>
    <button style="text-align: center; padding: 2%; background-color: aqua;" id="refreshButton">Refresh</button>
    <button style="text-align: center; padding: 2%; background-color: aqua;"><a
            style="text-decoration: none; color: black;" href="/">Stocks</a></button>
            <button style="text-align: center; padding: 2%; background-color: aqua;" ><a style="text-decoration: none; color: black;" href="/backtest">Back Test</a></button>
    <div id="dataContainer"></div>


    <script>
        const symbol_token_dict = {
  "FINNIFTY25NOV25FUT": "37052",
    "360ONE25NOV25FUT": "38313",
    "ABB25NOV25FUT": "38314",
    "APOLLOHOSP25NOV25FUT": "44173",
    "BHARATFORG25NOV25FUT": "48586",
    "CAMS25NOV25FUT": "48600",
    "HCLTECH25NOV25FUT": "48650",
    "FORTIS25NOV25FUT": "48637",
    "GRASIM25NOV25FUT": "48643",
    "HDFCLIFE25NOV25FUT": "48657",
    "IDEA25NOV25FUT": "48733",
    "IDFCFIRSTB25NOV25FUT": "48734",
    "IEX25NOV25FUT": "48735",
    "INFY25NOV25FUT": "48783",
    "JINDALSTEL25NOV25FUT": "48810",
    "JIOFIN25NOV25FUT": "48811",
    "JSWENERGY25NOV25FUT": "48816",
    "LICHSGFIN25NOV25FUT": "48864",
    "NAUKRI25NOV25FUT": "48916",
    "NTPC25NOV25FUT": "48960",
    "NUVAMA25NOV25FUT": "48961",
    "OIL25NOV25FUT": "48996",
    "PNB25NOV25FUT": "49067",
    "POWERGRID25NOV25FUT": "49073",
    "RELIANCE25NOV25FUT": "49078",
    "SRF25NOV25FUT": "49092",
    "BANKNIFTY25NOV25FUT": "37051",
    "ALKEM25NOV25FUT": "39030",
    "BAJAJ-AUTO25NOV25FUT": "48573",
    "BAJAJFINSV25NOV25FUT": "48574",
    "BOSCHLTD25NOV25FUT": "48596",
    "CANBK25NOV25FUT": "48602",
    "CDSL25NOV25FUT": "48603",
    "CHOLAFIN25NOV25FUT": "48606",
    "DLF25NOV25FUT": "48630",
    "DRREDDY25NOV25FUT": "48632",
    "EICHERMOT25NOV25FUT": "48633",
    "EXIDEIND25NOV25FUT": "48635",
    "GAIL25NOV25FUT": "48638",
    "HAL25NOV25FUT": "48644",
    "INDIANB25NOV25FUT": "48747",
    "JSWSTEEL25NOV25FUT": "48817",
    "LODHA25NOV25FUT": "48873",
    "MOTHERSON25NOV25FUT": "48902",
    "NATIONALUM25NOV25FUT": "48911",
    "NBCC25NOV25FUT": "48917",
    "OBEROIRLTY25NOV25FUT": "48963",
    "PATANJALI25NOV25FUT": "49056",
    "POLICYBZR25NOV25FUT": "49069",
    "RVNL25NOV25FUT": "49079",
    "ASHOKLEY25NOV25FUT": "44178",
    "ASTRAL25NOV25FUT": "46470",
    "BEL25NOV25FUT": "48582",
    "CGPOWER25NOV25FUT": "48605",
    "CYIENT25NOV25FUT": "48618",
    "DIXON25NOV25FUT": "48627",
    "IIFL25NOV25FUT": "48743",
    "IRCTC25NOV25FUT": "48799",
    "M&M25NOV25FUT": "48887",
    "PAYTM25NOV25FUT": "49057",
    "PERSISTENT25NOV25FUT": "49058",
    "PRESTIGE25NOV25FUT": "49075",
    "TRENT25NOV25FUT": "49134",
    "SUPREMEIND25NOV25FUT": "49094",
    "TORNTPHARM25NOV25FUT": "49132",
    "ADANIENSOL25NOV25FUT": "38316",
    "ASIANPAINT25NOV25FUT": "44179",
    "AXISBANK25NOV25FUT": "46477",
    "GLENMARK25NOV25FUT": "48639",
    "HAVELLS25NOV25FUT": "48649",
    "ICICIBANK25NOV25FUT": "48707",
    "JUBLFOOD25NOV25FUT": "48839",
    "KPITTECH25NOV25FUT": "48859",
    "PAGEIND25NOV25FUT": "49055",
    "PETRONET25NOV25FUT": "49059",
    "PFC25NOV25FUT": "49060",
    "RBLBANK25NOV25FUT": "49076",
    "SIEMENS25NOV25FUT": "49089",
    "TMPV25NOV25FUT": "49109",
    "TCS25NOV25FUT": "49119",
    "TITAGARH25NOV25FUT": "49130",
    "TECHM25NOV25FUT": "49126",
    "TIINDIA25NOV25FUT": "49127",
    "VBL25NOV25FUT": "49151",
    "ZYDUSLIFE25NOV25FUT": "49201",
    "POWERINDIA25NOV25FUT": "49975",
    "NIFTY25NOV25FUT": "37054",
    "ANGELONE25NOV25FUT": "44171",
    "BANKBARODA25NOV25FUT": "48579",
    "BANKINDIA25NOV25FUT": "48580",
    "BDL25NOV25FUT": "48581",
    "BSE25NOV25FUT": "48599",
    "COFORGE25NOV25FUT": "48609",
    "FEDERALBNK25NOV25FUT": "48636",
    "GODREJCP25NOV25FUT": "48641",
    "INOXWIND25NOV25FUT": "48797",
    "IRFC25NOV25FUT": "48802",
    "ITC25NOV25FUT": "48803",
    "LTF25NOV25FUT": "48878",
    "LUPIN25NOV25FUT": "48884",
    "NMDC25NOV25FUT": "48932",
    "PGEL25NOV25FUT": "49061",
    "PIIND25NOV25FUT": "49065",
    "PNBHOUSING25NOV25FUT": "49068",
    "SUNPHARMA25NOV25FUT": "49093",
    "SUZLON25NOV25FUT": "49095",
    "AUBANK25NOV25FUT": "46472",
    "BIOCON25NOV25FUT": "48594",
    "BRITANNIA25NOV25FUT": "48598",
    "DIVISLAB25NOV25FUT": "48626",
    "GMRAIRPORT25NOV25FUT": "48640",
    "GODREJPROP25NOV25FUT": "48642",
    "HDFCAMC25NOV25FUT": "48651",
    "INDUSTOWER25NOV25FUT": "48782",
    "IOC25NOV25FUT": "48798",
    "KFINTECH25NOV25FUT": "48857",
    "LT25NOV25FUT": "48874",
    "LTIM25NOV25FUT": "48879",
    "MANKIND25NOV25FUT": "48889",
    "MAXHEALTH25NOV25FUT": "48896",
    "NESTLEIND25NOV25FUT": "48921",
    "NHPC25NOV25FUT": "48931",
    "NYKAA25NOV25FUT": "48962",
    "OFSS25NOV25FUT": "48995",
    "SAMMAANCAP25NOV25FUT": "49083",
    "SOLARINDS25NOV25FUT": "49090",
    "TATACONSUM25NOV25FUT": "49097",
    "TATASTEEL25NOV25FUT": "49115",
    "TVSMOTOR25NOV25FUT": "49135",
    "UNITDSPR25NOV25FUT": "49139",
    "VEDL25NOV25FUT": "49163",
    "ULTRACEMCO25NOV25FUT": "49136",
    "ABCAPITAL25NOV25FUT": "38315",
    "ADANIENT25NOV25FUT": "38317",
    "ADANIGREEN25NOV25FUT": "39028",
    "APLAPOLLO25NOV25FUT": "44172",
    "BHARTIARTL25NOV25FUT": "48587",
    "BLUESTARCO25NOV25FUT": "48595",
    "CIPLA25NOV25FUT": "48607",
    "COALINDIA25NOV25FUT": "48608",
    "DABUR25NOV25FUT": "48619",
    "ETERNAL25NOV25FUT": "48634",
    "HFCL25NOV25FUT": "48671",
    "HINDPETRO25NOV25FUT": "48693",
    "ICICIPRULI25NOV25FUT": "48732",
    "IGL25NOV25FUT": "48742",
    "KALYANKJIL25NOV25FUT": "48840",
    "KEI25NOV25FUT": "48851",
    "KOTAKBANK25NOV25FUT": "48858",
    "MFSL25NOV25FUT": "48901",
    "NCC25NOV25FUT": "48920",
    "SBICARD25NOV25FUT": "49084",
    "PIDILITIND25NOV25FUT": "49064",
    "POLYCAB25NOV25FUT": "49071",
    "SBILIFE25NOV25FUT": "49085",
    "SBIN25NOV25FUT": "49086",
    "TATAPOWER25NOV25FUT": "49114",
    "UNIONBANK25NOV25FUT": "49137",
    "UNOMINDA25NOV25FUT": "49140",
    "YESBANK25NOV25FUT": "49171",
    "NIFTYNXT5025NOV25FUT": "38312",
    "AUROPHARMA25NOV25FUT": "46473",
    "BAJFINANCE25NOV25FUT": "48575",
    "BANDHANBNK25NOV25FUT": "48578",
    "CONCOR25NOV25FUT": "48612",
    "CUMMINSIND25NOV25FUT": "48614",
    "DALBHARAT25NOV25FUT": "48624",
    "DMART25NOV25FUT": "48631",
    "HDFCBANK25NOV25FUT": "48652",
    "HINDALCO25NOV25FUT": "48672",
    "HINDUNILVR25NOV25FUT": "48694",
    "HINDZINC25NOV25FUT": "48699",
    "INDHOTEL25NOV25FUT": "48746",
    "INDIGO25NOV25FUT": "48750",
    "INDUSINDBK25NOV25FUT": "48751",
    "KAYNES25NOV25FUT": "48850",
    "LAURUSLABS25NOV25FUT": "48860",
    "LICI25NOV25FUT": "48865",
    "MANAPPURAM25NOV25FUT": "48888",
    "MARICO25NOV25FUT": "48891",
    "MARUTI25NOV25FUT": "48892",
    "MPHASIS25NOV25FUT": "48904",
    "RECLTD25NOV25FUT": "49077",
    "SAIL25NOV25FUT": "49080",
    "SONACOMS25NOV25FUT": "49091",
    "TATAELXSI25NOV25FUT": "49108",
    "TATATECH25NOV25FUT": "49118",
    "VOLTAS25NOV25FUT": "49164",
    "MIDCPNIFTY25NOV25FUT": "37053",
    "ADANIPORTS25NOV25FUT": "39029",
    "AMBER25NOV25FUT": "39031",
    "AMBUJACEM25NOV25FUT": "44170",
    "BHEL25NOV25FUT": "48588",
    "BPCL25NOV25FUT": "48597",
    "COLPAL25NOV25FUT": "48610",
    "CROMPTON25NOV25FUT": "48613",
    "DELHIVERY25NOV25FUT": "48625",
    "HEROMOTOCO25NOV25FUT": "48658",
    "HUDCO25NOV25FUT": "48700",
    "ICICIGI25NOV25FUT": "48708",
    "IREDA25NOV25FUT": "48800",
    "MAZDOCK25NOV25FUT": "48897",
    "MCX25NOV25FUT": "48898",
    "MUTHOOTFIN25NOV25FUT": "48910",
    "ONGC25NOV25FUT": "49054",
    "PHOENIXLTD25NOV25FUT": "49062",
    "PPLPHARMA25NOV25FUT": "49074",
    "SHREECEM25NOV25FUT": "49087",
    "SHRIRAMFIN25NOV25FUT": "49088",
    "SYNGENE25NOV25FUT": "49096",
    "TITAN25NOV25FUT": "49131",
    "TORNTPOWER25NOV25FUT": "49133",
    "UPL25NOV25FUT": "49150",
    "WIPRO25NOV25FUT": "49170",
    "SILVERM28NOV25FUT": "440938",
    "CRUDEOIL19NOV25FUT": "457886",
    "NATGASMINI24NOV25FUT": "458148",
    "ZINC28NOV25FUT": "463277",
    "STEELREBAR28NOV25FUT": "463276",
    "GOLDPETAL28NOV25FUT": "466027",
    "ALUMINI28NOV25FUT": "463270",
    "MCXMETLDEX21NOV25FUT": "466582",
    "SILVERMIC28NOV25FUT": "450659",
    "CRUDEOILM19NOV25FUT": "457887",
    "KAPAS28NOV25FUT": "442172",
    "NATURALGAS24NOV25FUT": "458147",
    "MENTHAOIL28NOV25FUT": "458307",
    "LEAD28NOV25FUT": "463273",
    "ELECDMBL28NOV25FUT": "466030",
    "GOLDM05NOV25FUT": "466161",
    "MCXBULLDEX26NOV25FUT": "467012",
    "GOLDTEN28NOV25FUT": "467742",
    "COTTON28NOV25FUT": "463161",
    "ZINCMINI28NOV25FUT": "463278",
    "ALUMINIUM28NOV25FUT": "463271",
    "COPPER28NOV25FUT": "463272",
    "COTTONOIL28NOV25FUT": "466032",
    "NICKEL19NOV25FUT": "466525",
    "LEADMINI28NOV25FUT": "463274",
    "CARDAMOM28NOV25FUT": "465834",
            "THIS IS LAST >>>>>>REFRESH__AGAIN>>>>>> GOLDGUINEA28NOV25FUT": "466026"
        };

        async function fetchCandleDataSequential(tokens) {
            for (let token of tokens) {
                const tokenName = Object.keys(symbol_token_dict).find(key  => symbol_token_dict[key] === token).replace(/-EQ$/, '');
                try {
                    const response = await fetch(`/get_fut_data/${token}/${tokenName}`);
                    const data = await response.json();
                    displayData(token, data);
                } catch (error) {
                    console.error(`Error fetching data for token ${token}:`, error);
                }
            }
        }

        function displayData(token, data) {
            const dataContainer = document.getElementById('dataContainer');

            const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token);
            const today_len = data.data.length - 1;
            const yesterday_len = data.data.length - 2;
            const todayHigh = parseFloat(data.data[today_len]['2']);
            const todayLow = parseFloat(data.data[today_len]['3']);
            const yesterdayHigh = parseFloat(data.data[yesterday_len]['2']);
            const yesterdayLow = parseFloat(data.data[yesterday_len]['3']);
            const todayVol = parseFloat(data.data[today_len]['5']);
            const yesterdayVol = parseFloat(data.data[yesterday_len]['5']);

            const div = document.createElement('div');
            div.innerHTML = ` <br> <p class='share' > <b>${tokenName}:</b> ${JSON.stringify(data.data[today_len]['4'])}</p>
            <p class='share' > <b>Today:</b>  High: ${todayHigh} -- Low: ${todayLow} -- Volume: ${todayVol} </p>
            <p class='share' > <b>Yesterday:</b>  High: ${yesterdayHigh} -- Low: ${yesterdayLow} -- Volume: ${yesterdayVol} </p>
            <hr>`;



            if (todayHigh > yesterdayHigh && todayLow < yesterdayLow) {
                div.style.color = 'green';
                div.style.backgroundColor = 'chartreuse';
            } else {
                div.style.color = 'black';
            }


            if (dataContainer.firstChild) {
                dataContainer.insertBefore(div, dataContainer.firstChild);
            } else {
                dataContainer.appendChild(div);
            }
        }

        const tokens = Object.values(symbol_token_dict);
        console.log(tokens)

        fetchCandleDataSequential(tokens);

        function refreshData() {
            const dataContainer = document.getElementById('dataContainer');
            dataContainer.innerHTML = '';
            fetchCandleDataSequential(tokens);
        }
        document.getElementById('refreshButton').addEventListener('click', refreshData);
    </script>

</body>

</html>
