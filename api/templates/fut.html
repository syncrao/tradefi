<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradeFi</title>
    <style>
        .share {
            text-align: center;
        }
    </style>
</head>

<body>
    <button style="text-align: center; padding: 2%; background-color: aqua;" id="refreshButton">Refresh</button>
    <button style="text-align: center; padding: 2%; background-color: aqua;"><a
            style="text-decoration: none; color: black;" href="/">Stocks</a></button>
            <button style="text-align: center; padding: 2%; background-color: aqua;" ><a style="text-decoration: none; color: black;" href="/backtest">Back Test</a></button>
    <div id="dataContainer"></div>


    <script>
        const symbol_token_dict = {
    "360ONE30SEP25FUT": "53011",
    "ADANIPORTS30SEP25FUT": "53020",
    "CANBK30SEP25FUT": "53064",
    "COFORGE30SEP25FUT": "53086",
    "DELHIVERY30SEP25FUT": "53133",
    "DIXON30SEP25FUT": "53135",
    "DMART30SEP25FUT": "53138",
    "GODREJPROP30SEP25FUT": "53163",
    "INDUSINDBK30SEP25FUT": "53230",
    "KFINTECH30SEP25FUT": "53288",
    "MANAPPURAM30SEP25FUT": "53476",
    "NTPC30SEP25FUT": "53747",
    "PAYTM30SEP25FUT": "53755",
    "PGEL30SEP25FUT": "53765",
    "PNB30SEP25FUT": "53778",
    "PPLPHARMA30SEP25FUT": "53795",
    "SHRIRAMFIN30SEP25FUT": "53834",
    "SIEMENS30SEP25FUT": "53835",
    "TATAPOWER30SEP25FUT": "53877",
    "TATASTEEL30SEP25FUT": "53883",
    "ADANIENSOL30SEP25FUT": "53014",
    "ASHOKLEY30SEP25FUT": "53037",
    "ASTRAL30SEP25FUT": "53040",
    "BANKINDIA30SEP25FUT": "53049",
    "BRITANNIA30SEP25FUT": "53061",
    "CGPOWER30SEP25FUT": "53066",
    "CIPLA30SEP25FUT": "53069",
    "CYIENT30SEP25FUT": "53122",
    "GLENMARK30SEP25FUT": "53160",
    "HAVELLS30SEP25FUT": "53166",
    "HDFCAMC30SEP25FUT": "53170",
    "HINDALCO30SEP25FUT": "53175",
    "JINDALSTEL30SEP25FUT": "53243",
    "JSWSTEEL30SEP25FUT": "53271",
    "NATIONALUM30SEP25FUT": "53710",
    "NAUKRI30SEP25FUT": "53711",
    "NESTLEIND30SEP25FUT": "53720",
    "PIIND30SEP25FUT": "53777",
    "RECLTD30SEP25FUT": "53803",
    "SBICARD30SEP25FUT": "53809",
    "SRF30SEP25FUT": "53838",
    "SUPREMEIND30SEP25FUT": "53840",
    "TATACHEM30SEP25FUT": "53852",
    "TORNTPOWER30SEP25FUT": "53906",
    "UPL30SEP25FUT": "53918",
    "VOLTAS30SEP25FUT": "53923",
    "NUVAMA30SEP25FUT": "52476",
    "ABB30SEP25FUT": "53012",
    "BOSCHLTD30SEP25FUT": "53059",
    "CDSL30SEP25FUT": "53065",
    "CUMMINSIND30SEP25FUT": "53121",
    "FORTIS30SEP25FUT": "53154",
    "HINDZINC30SEP25FUT": "53186",
    "INDIANB30SEP25FUT": "53205",
    "INFY30SEP25FUT": "53232",
    "IOC30SEP25FUT": "53234",
    "JSWENERGY30SEP25FUT": "53267",
    "KAYNES30SEP25FUT": "53283",
    "LAURUSLABS30SEP25FUT": "53362",
    "KPITTECH30SEP25FUT": "53361",
    "MAXHEALTH30SEP25FUT": "53703",
    "MAZDOCK30SEP25FUT": "53704",
    "MFSL30SEP25FUT": "53706",
    "PHOENIXLTD30SEP25FUT": "53766",
    "POLYCAB30SEP25FUT": "53791",
    "PRESTIGE30SEP25FUT": "53798",
    "SBILIFE30SEP25FUT": "53812",
    "SBIN30SEP25FUT": "53815",
    "TATAELXSI30SEP25FUT": "53868",
    "TRENT30SEP25FUT": "53909",
    "APOLLOHOSP30SEP25FUT": "53036",
    "BHARATFORG30SEP25FUT": "53052",
    "BHEL30SEP25FUT": "53056",
    "GMRAIRPORT30SEP25FUT": "53161",
    "HAL30SEP25FUT": "53165",
    "HDFCBANK30SEP25FUT": "53171",
    "IDEA30SEP25FUT": "53192",
    "IEX30SEP25FUT": "53199",
    "IGL30SEP25FUT": "53200",
    "INDHOTEL30SEP25FUT": "53204",
    "ITC30SEP25FUT": "53242",
    "KOTAKBANK30SEP25FUT": "53360",
    "LODHA30SEP25FUT": "53365",
    "LUPIN30SEP25FUT": "53411",
    "M&M30SEP25FUT": "53412",
    "MARICO30SEP25FUT": "53492",
    "MPHASIS30SEP25FUT": "53708",
    "OBEROIRLTY30SEP25FUT": "53749",
    "ONGC30SEP25FUT": "53752",
    "PFC30SEP25FUT": "53759",
    "PNBHOUSING30SEP25FUT": "53779",
    "POLICYBZR30SEP25FUT": "53781",
    "RELIANCE30SEP25FUT": "53806",
    "SHREECEM30SEP25FUT": "53833",
    "SOLARINDS30SEP25FUT": "53836",
    "TCS30SEP25FUT": "53892",
    "ULTRACEMCO30SEP25FUT": "53912",
    "WIPRO30SEP25FUT": "53924",
    "YESBANK30SEP25FUT": "53925",
    "ANGELONE30SEP25FUT": "53033",
    "BHARTIARTL30SEP25FUT": "53055",
    "BIOCON30SEP25FUT": "53057",
    "CAMS30SEP25FUT": "53063",
    "CHOLAFIN30SEP25FUT": "53068",
    "COALINDIA30SEP25FUT": "53071",
    "DLF30SEP25FUT": "53136",
    "EXIDEIND30SEP25FUT": "53151",
    "HDFCLIFE30SEP25FUT": "53172",
    "HUDCO30SEP25FUT": "53187",
    "ICICIBANK30SEP25FUT": "53188",
    "IIFL30SEP25FUT": "53203",
    "INDUSTOWER30SEP25FUT": "53231",
    "KEI30SEP25FUT": "53285",
    "LTIM30SEP25FUT": "53410",
    "MANKIND30SEP25FUT": "53477",
    "MUTHOOTFIN30SEP25FUT": "53709",
    "NCC30SEP25FUT": "53715",
    "OIL30SEP25FUT": "53751",
    "RVNL30SEP25FUT": "53807",
    "SAIL30SEP25FUT": "53808",
    "SONACOMS30SEP25FUT": "53837",
    "SUNPHARMA30SEP25FUT": "53839",
    "TATACONSUM30SEP25FUT": "53867",
    "TITAGARH30SEP25FUT": "53900",
    "TITAN30SEP25FUT": "53901",
    "UNOMINDA30SEP25FUT": "53915",
    "FINNIFTY30SEP25FUT": "52997",
    "NIFTY30SEP25FUT": "53001",
    "ABCAPITAL30SEP25FUT": "53013",
    "AMBER30SEP25FUT": "53031",
    "ASIANPAINT30SEP25FUT": "53039",
    "AXISBANK30SEP25FUT": "53043",
    "BAJAJ-AUTO30SEP25FUT": "53044",
    "BEL30SEP25FUT": "53051",
    "DIVISLAB30SEP25FUT": "53134",
    "ETERNAL30SEP25FUT": "53150",
    "HCLTECH30SEP25FUT": "53169",
    "HFCL30SEP25FUT": "53174",
    "HINDUNILVR30SEP25FUT": "53185",
    "IRCTC30SEP25FUT": "53237",
    "JUBLFOOD30SEP25FUT": "53272",
    "PAGEIND30SEP25FUT": "53753",
    "PETRONET30SEP25FUT": "53758",
    "POWERGRID30SEP25FUT": "53792",
    "SAMMAANCAP30SEP25FUT": "49081",
    "BSE30SEP25FUT": "53062",
    "CONCOR30SEP25FUT": "53104",
    "CROMPTON30SEP25FUT": "53105",
    "DALBHARAT30SEP25FUT": "53132",
    "EICHERMOT30SEP25FUT": "53149",
    "INOXWIND30SEP25FUT": "53233",
    "LICHSGFIN30SEP25FUT": "53363",
    "LICI30SEP25FUT": "53364",
    "MCX30SEP25FUT": "53705",
    "MOTHERSON30SEP25FUT": "53707",
    "NBCC30SEP25FUT": "53714",
    "NHPC30SEP25FUT": "53721",
    "NYKAA30SEP25FUT": "53748",
    "OFSS30SEP25FUT": "53750",
    "PERSISTENT30SEP25FUT": "53757",
    "RBLBANK30SEP25FUT": "53802",
    "TATAMOTORS30SEP25FUT": "53869",
    "TECHM30SEP25FUT": "53896",
    "TVSMOTOR30SEP25FUT": "53911",
    "UNIONBANK30SEP25FUT": "53913",
    "ZYDUSLIFE30SEP25FUT": "53926",
    "SUZLON30SEP25FUT": "52524",
    "MIDCPNIFTY30SEP25FUT": "52998",
    "NIFTYNXT5030SEP25FUT": "53002",
    "ADANIGREEN30SEP25FUT": "53016",
    "ALKEM30SEP25FUT": "53021",
    "BAJAJFINSV30SEP25FUT": "53045",
    "BANKBARODA30SEP25FUT": "53048",
    "BDL30SEP25FUT": "53050",
    "DABUR30SEP25FUT": "53131",
    "DRREDDY30SEP25FUT": "53139",
    "FEDERALBNK30SEP25FUT": "53152",
    "GODREJCP30SEP25FUT": "53162",
    "HEROMOTOCO30SEP25FUT": "53173",
    "ICICIGI30SEP25FUT": "53189",
    "ICICIPRULI30SEP25FUT": "53190",
    "IDFCFIRSTB30SEP25FUT": "53193",
    "INDIGO30SEP25FUT": "53206",
    "IREDA30SEP25FUT": "53238",
    "IRFC30SEP25FUT": "53239",
    "JIOFIN30SEP25FUT": "53266",
    "KALYANKJIL30SEP25FUT": "53282",
    "MARUTI30SEP25FUT": "53493",
    "SYNGENE30SEP25FUT": "53851",
    "TATATECH30SEP25FUT": "53891",
    "UNITDSPR30SEP25FUT": "53914",
    "VBL30SEP25FUT": "53919",
    "BANKNIFTY30SEP25FUT": "52995",
    "ADANIENT30SEP25FUT": "53015",
    "AMBUJACEM30SEP25FUT": "53032",
    "APLAPOLLO30SEP25FUT": "53034",
    "AUBANK30SEP25FUT": "53041",
    "AUROPHARMA30SEP25FUT": "53042",
    "BAJFINANCE30SEP25FUT": "53046",
    "BANDHANBNK30SEP25FUT": "53047",
    "BLUESTARCO30SEP25FUT": "53058",
    "BPCL30SEP25FUT": "53060",
    "COLPAL30SEP25FUT": "53087",
    "GAIL30SEP25FUT": "53159",
    "GRASIM30SEP25FUT": "53164",
    "HINDPETRO30SEP25FUT": "53176",
    "LT30SEP25FUT": "53400",
    "LTF30SEP25FUT": "53401",
    "NMDC30SEP25FUT": "53746",
    "PATANJALI30SEP25FUT": "53754",
    "PIDILITIND30SEP25FUT": "53769",
    "TIINDIA30SEP25FUT": "53899",
    "TORNTPHARM30SEP25FUT": "53902",
    "VEDL30SEP25FUT": "53921",
    "NATURALGAS25SEP25FUT": "452643",
    "SILVER05SEP25FUT": "439488",
    "COTTONCNDY30SEP25FUT": "450654",
    "CRUDEOIL19SEP25FUT": "452373",
    "CRUDEOILM19SEP25FUT": "452374",
    "ALUMINIUM30SEP25FUT": "456954",
    "LEAD30SEP25FUT": "456956",
    "GOLDGUINEA30SEP25FUT": "458302",
    "ALUMINI30SEP25FUT": "456953",
    "LEADMINI30SEP25FUT": "456957",
    "MCXBULLDEX23SEP25FUT": "462761",
    "ZINCMINI30SEP25FUT": "456960",
    "ELECDMBL29SEP25FUT": "463397",
    "ZINC30SEP25FUT": "456959",
    "MENTHAOIL30SEP25FUT": "452855",
    "NATGASMINI25SEP25FUT": "452644",
    "GOLDM05SEP25FUT": "458697",
    "MCXMETLDEX23SEP25FUT": "459282",
    "COPPER30SEP25FUT": "456955",
    "GOLDPETAL30SEP25FUT": "458303",
    "COTTONOIL30SEP25FUT": "458306",
    "STEELREBAR30SEP25FUT": "456961",
    "GOLDTEN30SEP25FUT": "463267",
    "CARDAMOM30SEP25FUT": "465832",
            "THIS IS LAST >>>>>>REFRESH__AGAIN>>>>>> NICKEL17SEP25FUT": "466571"
        };

        async function fetchCandleDataSequential(tokens) {
            for (let token of tokens) {
                const tokenName = Object.keys(symbol_token_dict).find(key  => symbol_token_dict[key] === token).replace(/-EQ$/, '');
                try {
                    const response = await fetch(`/get_fut_data/${token}/${tokenName}`);
                    const data = await response.json();
                    displayData(token, data);
                } catch (error) {
                    console.error(`Error fetching data for token ${token}:`, error);
                }
            }
        }

        function displayData(token, data) {
            const dataContainer = document.getElementById('dataContainer');

            const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token);
            const today_len = data.data.length - 1;
            const yesterday_len = data.data.length - 2;
            const todayHigh = parseFloat(data.data[today_len]['2']);
            const todayLow = parseFloat(data.data[today_len]['3']);
            const yesterdayHigh = parseFloat(data.data[yesterday_len]['2']);
            const yesterdayLow = parseFloat(data.data[yesterday_len]['3']);
            const todayVol = parseFloat(data.data[today_len]['5']);
            const yesterdayVol = parseFloat(data.data[yesterday_len]['5']);

            const div = document.createElement('div');
            div.innerHTML = ` <br> <p class='share' > <b>${tokenName}:</b> ${JSON.stringify(data.data[today_len]['4'])}</p>
            <p class='share' > <b>Today:</b>  High: ${todayHigh} -- Low: ${todayLow} -- Volume: ${todayVol} </p>
            <p class='share' > <b>Yesterday:</b>  High: ${yesterdayHigh} -- Low: ${yesterdayLow} -- Volume: ${yesterdayVol} </p>
            <hr>`;



            if (todayHigh > yesterdayHigh && todayLow < yesterdayLow) {
                div.style.color = 'green';
                div.style.backgroundColor = 'chartreuse';
            } else {
                div.style.color = 'black';
            }


            if (dataContainer.firstChild) {
                dataContainer.insertBefore(div, dataContainer.firstChild);
            } else {
                dataContainer.appendChild(div);
            }
        }

        const tokens = Object.values(symbol_token_dict);
        console.log(tokens)

        fetchCandleDataSequential(tokens);

        function refreshData() {
            const dataContainer = document.getElementById('dataContainer');
            dataContainer.innerHTML = '';
            fetchCandleDataSequential(tokens);
        }
        document.getElementById('refreshButton').addEventListener('click', refreshData);
    </script>

</body>

</html>
