<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradeFi</title>
    <style>
        .share {
            text-align: center;
        }
    </style>
</head>

<body>
    <button style="text-align: center; padding: 2%; background-color: aqua;" id="refreshButton">Refresh</button>
    <button style="text-align: center; padding: 2%; background-color: aqua;"><a
            style="text-decoration: none; color: black;" href="/">Stocks</a></button>
            <button style="text-align: center; padding: 2%; background-color: aqua;" ><a style="text-decoration: none; color: black;" href="/backtest">Back Test</a></button>
    <div id="dataContainer"></div>


    <script>
        const symbol_token_dict = {
     "ABB27JAN26FUT": "49236",
    "ASHOKLEY27JAN26FUT": "49269",
    "BEL27JAN26FUT": "49312",
    "CDSL27JAN26FUT": "49330",
    "CIPLA27JAN26FUT": "49335",
    "EICHERMOT27JAN26FUT": "49375",
    "EXIDEIND27JAN26FUT": "49384",
    "GLENMARK27JAN26FUT": "49394",
    "GMRAIRPORT27JAN26FUT": "49395",
    "HDFCAMC27JAN26FUT": "49402",
    "IREDA27JAN26FUT": "49488",
    "KAYNES27JAN26FUT": "49509",
    "KOTAKBANK27JAN26FUT": "49523",
    "LUPIN27JAN26FUT": "49600",
    "MFSL27JAN26FUT": "49627",
    "LODHA27JAN26FUT": "49586",
    "MAXHEALTH27JAN26FUT": "49608",
    "MUTHOOTFIN27JAN26FUT": "49636",
    "PIDILITIND27JAN26FUT": "49981",
    "TVSMOTOR27JAN26FUT": "50247",
    "SAIL27JAN26FUT": "49995",
    "TATACONSUM27JAN26FUT": "50134",
    "TMPV27JAN26FUT": "50229",
    "AUBANK27JAN26FUT": "49278",
    "DIVISLAB27JAN26FUT": "49363",
    "HAL27JAN26FUT": "49399",
    "HDFCBANK27JAN26FUT": "49422",
    "HINDPETRO27JAN26FUT": "49427",
    "HINDZINC27JAN26FUT": "49429",
    "INDIANB27JAN26FUT": "49447",
    "ITC27JAN26FUT": "49493",
    "JIOFIN27JAN26FUT": "49495",
    "M&M27JAN26FUT": "49601",
    "MANAPPURAM27JAN26FUT": "49603",
    "MANKIND27JAN26FUT": "49604",
    "NAUKRI27JAN26FUT": "49658",
    "OIL27JAN26FUT": "49798",
    "PHOENIXLTD27JAN26FUT": "49980",
    "POWERINDIA27JAN26FUT": "49988",
    "PPLPHARMA27JAN26FUT": "49989",
    "RBLBANK27JAN26FUT": "49991",
    "RVNL27JAN26FUT": "49994",
    "SOLARINDS27JAN26FUT": "50031",
    "SUPREMEIND27JAN26FUT": "50081",
    "SUZLON27JAN26FUT": "50131",
    "SYNGENE27JAN26FUT": "50133",
    "TATASTEEL27JAN26FUT": "50175",
    "TORNTPOWER27JAN26FUT": "50239",
    "VBL27JAN26FUT": "50341",
    "WIPRO27JAN26FUT": "50366",
    "FINNIFTY27JAN26FUT": "49225",
    "MIDCPNIFTY27JAN26FUT": "49226",
    "ABCAPITAL27JAN26FUT": "49237",
    "ADANIENSOL27JAN26FUT": "49239",
    "AMBER27JAN26FUT": "49260",
    "FORTIS27JAN26FUT": "49392",
    "GODREJCP27JAN26FUT": "49396",
    "IDFCFIRSTB27JAN26FUT": "49437",
    "INFY27JAN26FUT": "49481",
    "NATIONALUM27JAN26FUT": "49645",
    "NTPC27JAN26FUT": "49727",
    "PGEL27JAN26FUT": "49979",
    "TATAELXSI27JAN26FUT": "50137",
    "TATATECH27JAN26FUT": "50186",
    "TIINDIA27JAN26FUT": "50203",
    "TITAN27JAN26FUT": "50228",
    "TORNTPHARM27JAN26FUT": "50236",
    "ULTRACEMCO27JAN26FUT": "50260",
    "NIFTYNXT5027JAN26FUT": "49234",
    "ASTRAL27JAN26FUT": "49277",
    "BAJAJ-AUTO27JAN26FUT": "49303",
    "BLUESTARCO27JAN26FUT": "49323",
    "BPCL27JAN26FUT": "49325",
    "CAMS27JAN26FUT": "49328",
    "CHOLAFIN27JAN26FUT": "49332",
    "COLPAL27JAN26FUT": "49343",
    "DRREDDY27JAN26FUT": "49374",
    "HCLTECH27JAN26FUT": "49401",
    "HEROMOTOCO27JAN26FUT": "49425",
    "IEX27JAN26FUT": "49438",
    "INDUSTOWER27JAN26FUT": "49450",
    "LAURUSLABS27JAN26FUT": "49549",
    "MOTHERSON27JAN26FUT": "49630",
    "ONGC27JAN26FUT": "49811",
    "PERSISTENT27JAN26FUT": "49976",
    "YESBANK27JAN26FUT": "50367",
    "ASIANPAINT27JAN26FUT": "49270",
    "BHEL27JAN26FUT": "49319",
    "CANBK27JAN26FUT": "49329",
    "CGPOWER27JAN26FUT": "49331",
    "COALINDIA27JAN26FUT": "49336",
    "DALBHARAT27JAN26FUT": "49353",
    "DIXON27JAN26FUT": "49364",
    "ETERNAL27JAN26FUT": "49383",
    "GODREJPROP27JAN26FUT": "49397",
    "GRASIM27JAN26FUT": "49398",
    "ICICIGI27JAN26FUT": "49432",
    "INDHOTEL27JAN26FUT": "49443",
    "KALYANKJIL27JAN26FUT": "49503",
    "KFINTECH27JAN26FUT": "49518",
    "LT27JAN26FUT": "49587",
    "MAZDOCK27JAN26FUT": "49609",
    "NBCC27JAN26FUT": "49677",
    "NESTLEIND27JAN26FUT": "49678",
    "NHPC27JAN26FUT": "49701",
    "PAYTM27JAN26FUT": "49832",
    "POWERGRID27JAN26FUT": "49987",
    "TECHM27JAN26FUT": "50202",
    "360ONE27JAN26FUT": "49235",
    "ADANIENT27JAN26FUT": "49240",
    "ADANIPORTS27JAN26FUT": "49242",
    "APOLLOHOSP27JAN26FUT": "49267",
    "BAJFINANCE27JAN26FUT": "49305",
    "BHARATFORG27JAN26FUT": "49317",
    "BOSCHLTD27JAN26FUT": "49324",
    "BSE27JAN26FUT": "49327",
    "DELHIVERY27JAN26FUT": "49354",
    "HINDUNILVR27JAN26FUT": "49428",
    "ICICIPRULI27JAN26FUT": "49435",
    "IRCTC27JAN26FUT": "49486",
    "JSWSTEEL27JAN26FUT": "49497",
    "MPHASIS27JAN26FUT": "49635",
    "PAGEIND27JAN26FUT": "49815",
    "POLICYBZR27JAN26FUT": "49985",
    "RELIANCE27JAN26FUT": "49993",
    "SBIN27JAN26FUT": "50005",
    "SUNPHARMA27JAN26FUT": "50080",
    "VEDL27JAN26FUT": "50364",
    "UNIONBANK27JAN26FUT": "50261",
    "UNITDSPR27JAN26FUT": "50293",
    "UPL27JAN26FUT": "50340",
    "NIFTY27JAN26FUT": "49229",
    "BHARTIARTL27JAN26FUT": "49318",
    "BIOCON27JAN26FUT": "49320",
    "HAVELLS27JAN26FUT": "49400",
    "HDFCLIFE27JAN26FUT": "49423",
    "INOXWIND27JAN26FUT": "49482",
    "IRFC27JAN26FUT": "49492",
    "JUBLFOOD27JAN26FUT": "49498",
    "KEI27JAN26FUT": "49510",
    "KPITTECH27JAN26FUT": "49525",
    "LICI27JAN26FUT": "49585",
    "PIIND27JAN26FUT": "49982",
    "PNB27JAN26FUT": "49983",
    "PRESTIGE27JAN26FUT": "49990",
    "SBICARD27JAN26FUT": "49997",
    "SBILIFE27JAN26FUT": "50004",
    "SHREECEM27JAN26FUT": "50011",
    "TATAPOWER27JAN26FUT": "50174",
    "TCS27JAN26FUT": "50187",
    "TRENT27JAN26FUT": "50246",
    "ADANIGREEN27JAN26FUT": "49241",
    "ANGELONE27JAN26FUT": "49265",
    "APLAPOLLO27JAN26FUT": "49266",
    "AXISBANK27JAN26FUT": "49282",
    "BANDHANBNK27JAN26FUT": "49306",
    "BANKBARODA27JAN26FUT": "49307",
    "CUMMINSIND27JAN26FUT": "49351",
    "DLF27JAN26FUT": "49370",
    "DMART27JAN26FUT": "49372",
    "HUDCO27JAN26FUT": "49430",
    "INDIGO27JAN26FUT": "49448",
    "IOC27JAN26FUT": "49485",
    "LTF27JAN26FUT": "49592",
    "LTIM27JAN26FUT": "49599",
    "MARICO27JAN26FUT": "49606",
    "OBEROIRLTY27JAN26FUT": "49750",
    "PFC27JAN26FUT": "49978",
    "POLYCAB27JAN26FUT": "49986",
    "SHRIRAMFIN27JAN26FUT": "50017",
    "SIEMENS27JAN26FUT": "50030",
    "SONACOMS27JAN26FUT": "50032",
    "UNOMINDA27JAN26FUT": "50294",
    "VOLTAS27JAN26FUT": "50365",
    "ZYDUSLIFE27JAN26FUT": "50391",
    "BANKNIFTY27JAN26FUT": "49224",
    "ALKEM27JAN26FUT": "49259",
    "AMBUJACEM27JAN26FUT": "49263",
    "BAJAJFINSV27JAN26FUT": "49304",
    "BANKINDIA27JAN26FUT": "49308",
    "BDL27JAN26FUT": "49310",
    "BRITANNIA27JAN26FUT": "49326",
    "COFORGE27JAN26FUT": "49342",
    "DABUR27JAN26FUT": "49352",
    "FEDERALBNK27JAN26FUT": "49391",
    "GAIL27JAN26FUT": "49393",
    "HINDALCO27JAN26FUT": "49426",
    "ICICIBANK27JAN26FUT": "49431",
    "IIFL27JAN26FUT": "49442",
    "JINDALSTEL27JAN26FUT": "49494",
    "JSWENERGY27JAN26FUT": "49496",
    "MARUTI27JAN26FUT": "49607",
    "MCX27JAN26FUT": "49614",
    "NUVAMA27JAN26FUT": "49733",
    "NYKAA27JAN26FUT": "49734",
    "OFSS27JAN26FUT": "49797",
    "RECLTD27JAN26FUT": "49992",
    "SAMMAANCAP27JAN26FUT": "49996",
    "SRF27JAN26FUT": "50033",
    "LICHSGFIN27JAN26FUT": "49554",
    "PETRONET27JAN26FUT": "49977",
    "PREMIERENE27JAN26FUT": "52016",
    "PNBHOUSING27JAN26FUT": "49984",
    "NMDC27JAN26FUT": "49704",
    "INDUSINDBK27JAN26FUT": "49449",
    "WAAREEENER27JAN26FUT": "52071",
    "AUROPHARMA27JAN26FUT": "49279",
    "CONCOR27JAN26FUT": "49349",
    "IDEA27JAN26FUT": "49436",
    "PATANJALI27JAN26FUT": "49831",
    "SWIGGY27JAN26FUT": "52044",
    "CROMPTON27JAN26FUT": "49350",
    "BAJAJHLDNG27JAN26FUT": "51816",
    "COTTON30JAN26FUT": "463163",
    "COTTONOIL30JAN26FUT": "477182",
    "CRUDEOILM16JAN26FUT": "464926",
    "CRUDEOIL16JAN26FUT": "464925",
    "MENTHAOIL30JAN26FUT": "466033",
    "ALUMINI30JAN26FUT": "467732",
    "STEELREBAR30JAN26FUT": "467736",
    "LEADMINI30JAN26FUT": "467735",
    "ZINC30JAN26FUT": "467737",
    "NATURALGAS27JAN26FUT": "465849",
    "NATGASMINI27JAN26FUT": "465850",
    "ZINCMINI30JAN26FUT": "467738",
    "CARDAMOM30JAN26FUT": "467747",
    "GOLDM05JAN26FUT": "472779",
    "GOLDTEN30JAN26FUT": "472783",
    "ALUMINIUM30JAN26FUT": "467731",
    "NICKEL21JAN26FUT": "467739",
    "COPPER30JAN26FUT": "467733",
    "GOLDGUINEA30JAN26FUT": "472785",
    "GOLDPETAL30JAN26FUT": "472787",
    "LEAD30JAN26FUT": "467734",
    "MCXMETLDEX22JAN26FUT": "483073",
    "MCXBULLDEX27JAN26FUT": "486243",
            "THIS IS LAST >>>>>>REFRESH__AGAIN>>>>>> ELECDMBL30JAN26FUT": "477185"
        };

        async function fetchCandleDataSequential(tokens) {
            for (let token of tokens) {
                const tokenName = Object.keys(symbol_token_dict).find(key  => symbol_token_dict[key] === token).replace(/-EQ$/, '');
                try {
                    const response = await fetch(`/get_fut_data/${token}/${tokenName}`);
                    const data = await response.json();
                    displayData(token, data);
                } catch (error) {
                    console.error(`Error fetching data for token ${token}:`, error);
                }
            }
        }

        function displayData(token, data) {
            const dataContainer = document.getElementById('dataContainer');

            const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token);
            const today_len = data.data.length - 1;
            const yesterday_len = data.data.length - 2;
            const todayHigh = parseFloat(data.data[today_len]['2']);
            const todayLow = parseFloat(data.data[today_len]['3']);
            const yesterdayHigh = parseFloat(data.data[yesterday_len]['2']);
            const yesterdayLow = parseFloat(data.data[yesterday_len]['3']);
            const todayVol = parseFloat(data.data[today_len]['5']);
            const yesterdayVol = parseFloat(data.data[yesterday_len]['5']);

            const div = document.createElement('div');
            div.innerHTML = ` <br> <p class='share' > <b>${tokenName}:</b> ${JSON.stringify(data.data[today_len]['4'])}</p>
            <p class='share' > <b>Today:</b>  High: ${todayHigh} -- Low: ${todayLow} -- Volume: ${todayVol} </p>
            <p class='share' > <b>Yesterday:</b>  High: ${yesterdayHigh} -- Low: ${yesterdayLow} -- Volume: ${yesterdayVol} </p>
            <hr>`;



            if (todayHigh > yesterdayHigh && todayLow < yesterdayLow) {
                div.style.color = 'green';
                div.style.backgroundColor = 'chartreuse';
            } else {
                div.style.color = 'black';
            }


            if (dataContainer.firstChild) {
                dataContainer.insertBefore(div, dataContainer.firstChild);
            } else {
                dataContainer.appendChild(div);
            }
        }

        const tokens = Object.values(symbol_token_dict);
        console.log(tokens)

        fetchCandleDataSequential(tokens);

        function refreshData() {
            const dataContainer = document.getElementById('dataContainer');
            dataContainer.innerHTML = '';
            fetchCandleDataSequential(tokens);
        }
        document.getElementById('refreshButton').addEventListener('click', refreshData);
    </script>

</body>

</html>
