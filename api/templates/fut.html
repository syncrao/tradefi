<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradeFi</title>
    <style>
        .share {
            text-align: center;
        }
    </style>
</head>

<body>
    <button style="text-align: center; padding: 2%; background-color: aqua;" id="refreshButton">Refresh</button>
    <button style="text-align: center; padding: 2%; background-color: aqua;"><a
            style="text-decoration: none; color: black;" href="/">Stocks</a></button>
            <button style="text-align: center; padding: 2%; background-color: aqua;" ><a style="text-decoration: none; color: black;" href="/backtest">Back Test</a></button>
    <div id="dataContainer"></div>


    <script>
        const symbol_token_dict = {
 "FINNIFTY31JUL25FUT": "53214",
    "NIFTY31JUL25FUT": "53216",
    "APLAPOLLO31JUL25FUT": "53240",
    "ASTRAL31JUL25FUT": "53246",
    "AUROPHARMA31JUL25FUT": "53249",
    "BAJAJ-AUTO31JUL25FUT": "53251",
    "DLF31JUL25FUT": "53298",
    "DRREDDY31JUL25FUT": "53300",
    "EICHERMOT31JUL25FUT": "53301",
    "GAIL31JUL25FUT": "53305",
    "GMRAIRPORT31JUL25FUT": "53307",
    "GRASIM31JUL25FUT": "53311",
    "IIFL31JUL25FUT": "53337",
    "IOC31JUL25FUT": "53345",
    "IRCTC31JUL25FUT": "53347",
    "KEI31JUL25FUT": "53368",
    "KPITTECH31JUL25FUT": "53370",
    "LTF31JUL25FUT": "53376",
    "SAIL31JUL25FUT": "53430",
    "TATAMOTORS31JUL25FUT": "53452",
    "ULTRACEMCO31JUL25FUT": "53471",
    "UPL31JUL25FUT": "53474",
    "ABFRL31JUL25FUT": "53221",
    "BIOCON31JUL25FUT": "53262",
    "BPCL31JUL25FUT": "53264",
    "COALINDIA31JUL25FUT": "53280",
    "CYIENT31JUL25FUT": "53292",
    "DMART31JUL25FUT": "53299",
    "HDFCLIFE31JUL25FUT": "53317",
    "HINDCOPPER31JUL25FUT": "53322",
    "INDIANB31JUL25FUT": "53339",
    "INDIGO31JUL25FUT": "53340",
    "IREDA31JUL25FUT": "53348",
    "JINDALSTEL31JUL25FUT": "53353",
    "KALYANKJIL31JUL25FUT": "53367",
    "KOTAKBANK31JUL25FUT": "53369",
    "LTIM31JUL25FUT": "53377",
    "MARUTI31JUL25FUT": "53383",
    "MCX31JUL25FUT": "53385",
    "NBCC31JUL25FUT": "53393",
    "OBEROIRLTY31JUL25FUT": "53402",
    "PERSISTENT31JUL25FUT": "53413",
    "POLICYBZR31JUL25FUT": "53422",
    "POONAWALLA31JUL25FUT": "53424",
    "RELIANCE31JUL25FUT": "53429",
    "SJVN31JUL25FUT": "53437",
    "TATAELXSI31JUL25FUT": "53451",
    "TATASTEEL31JUL25FUT": "53454",
    "TECHM31JUL25FUT": "53461",
    "TORNTPOWER31JUL25FUT": "53468",
    "UNITDSPR31JUL25FUT": "53473",
    "VEDL31JUL25FUT": "53478",
    "ZYDUSLIFE31JUL25FUT": "53484",
    "ADANIENT31JUL25FUT": "53224",
    "ADANIGREEN31JUL25FUT": "53225",
    "APOLLOHOSP31JUL25FUT": "53241",
    "BHARTIARTL31JUL25FUT": "53260",
    "CUMMINSIND31JUL25FUT": "53291",
    "DELHIVERY31JUL25FUT": "53295",
    "GLENMARK31JUL25FUT": "53306",
    "GODREJCP31JUL25FUT": "53308",
    "HINDUNILVR31JUL25FUT": "53324",
    "ICICIBANK31JUL25FUT": "53327",
    "IDEA31JUL25FUT": "53330",
    "INDHOTEL31JUL25FUT": "53338",
    "INOXWIND31JUL25FUT": "53344",
    "LODHA31JUL25FUT": "53374",
    "MAXHEALTH31JUL25FUT": "53384",
    "NYKAA31JUL25FUT": "53399",
    "PNB31JUL25FUT": "53420",
    "POWERGRID31JUL25FUT": "53425",
    "RECLTD31JUL25FUT": "53428",
    "SIEMENS31JUL25FUT": "53436",
    "TATACHEM31JUL25FUT": "53448",
    "TATATECH31JUL25FUT": "53455",
    "TORNTPHARM31JUL25FUT": "53467",
    "RVNL31JUL25FUT": "64997",
    "360ONE31JUL25FUT": "53003",
    "AMBUJACEM31JUL25FUT": "53235",
    "BAJAJFINSV31JUL25FUT": "53252",
    "BAJFINANCE31JUL25FUT": "53253",
    "BANDHANBNK31JUL25FUT": "53255",
    "BANKINDIA31JUL25FUT": "53257",
    "BHARATFORG31JUL25FUT": "53259",
    "BRITANNIA31JUL25FUT": "53265",
    "BSOFT31JUL25FUT": "53269",
    "CAMS31JUL25FUT": "53270",
    "DIVISLAB31JUL25FUT": "53296",
    "DIXON31JUL25FUT": "53297",
    "EXIDEIND31JUL25FUT": "53303",
    "HAVELLS31JUL25FUT": "53313",
    "HEROMOTOCO31JUL25FUT": "53318",
    "HINDALCO31JUL25FUT": "53321",
    "IRB31JUL25FUT": "53346",
    "JSL31JUL25FUT": "53355",
    "JSWSTEEL31JUL25FUT": "53359",
    "LICI31JUL25FUT": "53373",
    "NATIONALUM31JUL25FUT": "53391",
    "NCC31JUL25FUT": "53394",
    "OFSS31JUL25FUT": "53403",
    "PAGEIND31JUL25FUT": "53406",
    "PRESTIGE31JUL25FUT": "53426",
    "SBICARD31JUL25FUT": "53431",
    "TCS31JUL25FUT": "53460",
    "TIINDIA31JUL25FUT": "53464",
    "UNIONBANK31JUL25FUT": "53472",
    "YESBANK31JUL25FUT": "53481",
    "MAZDOCK31JUL25FUT": "64907",
    "NIFTYNXT5031JUL25FUT": "53217",
    "BANKBARODA31JUL25FUT": "53256",
    "BEL31JUL25FUT": "53258",
    "BSE31JUL25FUT": "53268",
    "CANBK31JUL25FUT": "53273",
    "CDSL31JUL25FUT": "53274",
    "CESC31JUL25FUT": "53275",
    "CONCOR31JUL25FUT": "53289",
    "DALBHARAT31JUL25FUT": "53294",
    "ETERNAL31JUL25FUT": "53302",
    "FEDERALBNK31JUL25FUT": "53304",
    "HDFCAMC31JUL25FUT": "53315",
    "INDUSINDBK31JUL25FUT": "53341",
    "INDUSTOWER31JUL25FUT": "53342",
    "INFY31JUL25FUT": "53343",
    "JUBLFOOD31JUL25FUT": "53366",
    "MFSL31JUL25FUT": "53386",
    "NHPC31JUL25FUT": "53396",
    "NTPC31JUL25FUT": "53398",
    "PEL31JUL25FUT": "53409",
    "PETRONET31JUL25FUT": "53414",
    "SHREECEM31JUL25FUT": "53434",
    "SONACOMS31JUL25FUT": "53439",
    "TATACONSUM31JUL25FUT": "53450",
    "TITAGARH31JUL25FUT": "53465",
    "VOLTAS31JUL25FUT": "53479",
    "WIPRO31JUL25FUT": "53480",
    "AMBER31JUL25FUT": "53027",
    "MIDCPNIFTY31JUL25FUT": "53215",
    "ABCAPITAL31JUL25FUT": "53220",
    "ACC31JUL25FUT": "53222",
    "ANGELONE31JUL25FUT": "53236",
    "AXISBANK31JUL25FUT": "53250",
    "COFORGE31JUL25FUT": "53281",
    "COLPAL31JUL25FUT": "53284",
    "KFINTECH31JUL25FUT": "53286",
    "HUDCO31JUL25FUT": "53326",
    "IDFCFIRSTB31JUL25FUT": "53334",
    "IEX31JUL25FUT": "53335",
    "ITC31JUL25FUT": "53352",
    "JSWENERGY31JUL25FUT": "53358",
    "NAUKRI31JUL25FUT": "53392",
    "LUPIN31JUL25FUT": "53378",
    "MGL31JUL25FUT": "53387",
    "PAYTM31JUL25FUT": "53408",
    "PFC31JUL25FUT": "53415",
    "PNBHOUSING31JUL25FUT": "53421",
    "SRF31JUL25FUT": "53440",
    "SYNGENE31JUL25FUT": "53443",
    "TATACOMM31JUL25FUT": "53449",
    "TATAPOWER31JUL25FUT": "53453",
    "VBL31JUL25FUT": "53475",
    "BHEL31JUL25FUT": "53261",
    "BOSCHLTD31JUL25FUT": "53263",
    "CHOLAFIN31JUL25FUT": "53278",
    "CROMPTON31JUL25FUT": "53290",
    "DABUR31JUL25FUT": "53293",
    "GRANULES31JUL25FUT": "53310",
    "HCLTECH31JUL25FUT": "53314",
    "HDFCBANK31JUL25FUT": "53316",
    "ICICIGI31JUL25FUT": "53328",
    "IGL31JUL25FUT": "53336",
    "JIOFIN31JUL25FUT": "53354",
    "LAURUSLABS31JUL25FUT": "53371",
    "LICHSGFIN31JUL25FUT": "53372",
    "MANAPPURAM31JUL25FUT": "53381",
    "NMDC31JUL25FUT": "53397",
    "PHOENIXLTD31JUL25FUT": "53416",
    "POLYCAB31JUL25FUT": "53423",
    "SHRIRAMFIN31JUL25FUT": "53435",
    "TITAN31JUL25FUT": "53466",
    "PPLPHARMA31JUL25FUT": "64988",
    "BANKNIFTY31JUL25FUT": "53213",
    "AARTIIND31JUL25FUT": "53218",
    "ASIANPAINT31JUL25FUT": "53245",
    "AUBANK31JUL25FUT": "53248",
    "CGPOWER31JUL25FUT": "53276",
    "GODREJPROP31JUL25FUT": "53309",
    "HAL31JUL25FUT": "53312",
    "HINDPETRO31JUL25FUT": "53323",
    "ICICIPRULI31JUL25FUT": "53329",
    "IRFC31JUL25FUT": "53351",
    "M&MFIN31JUL25FUT": "53380",
    "MARICO31JUL25FUT": "53382",
    "MPHASIS31JUL25FUT": "53389",
    "MUTHOOTFIN31JUL25FUT": "53390",
    "OIL31JUL25FUT": "53404",
    "SBILIFE31JUL25FUT": "53432",
    "SBIN31JUL25FUT": "53433",
    "SOLARINDS31JUL25FUT": "53438",
    "KAYNES31JUL25FUT": "64624",
    "UNOMINDA31JUL25FUT": "65239",
    "ABB31JUL25FUT": "53219",
    "ADANIENSOL31JUL25FUT": "53223",
    "ADANIPORTS31JUL25FUT": "53226",
    "ALKEM31JUL25FUT": "53227",
    "ASHOKLEY31JUL25FUT": "53244",
    "ATGL31JUL25FUT": "53247",
    "BALKRISIND31JUL25FUT": "53254",
    "CHAMBLFERT31JUL25FUT": "53277",
    "CIPLA31JUL25FUT": "53279",
    "HFCL31JUL25FUT": "53319",
    "HINDZINC31JUL25FUT": "53325",
    "LT31JUL25FUT": "53375",
    "M&M31JUL25FUT": "53379",
    "MOTHERSON31JUL25FUT": "53388",
    "NESTLEIND31JUL25FUT": "53395",
    "ONGC31JUL25FUT": "53405",
    "PATANJALI31JUL25FUT": "53407",
    "PIDILITIND31JUL25FUT": "53418",
    "PIIND31JUL25FUT": "53419",
    "RBLBANK31JUL25FUT": "53427",
    "SUNPHARMA31JUL25FUT": "53441",
    "SUPREMEIND31JUL25FUT": "53442",
    "TRENT31JUL25FUT": "53469",
    "TVSMOTOR31JUL25FUT": "53470",
    "PGEL31JUL25FUT": "53763",
    "BDL31JUL25FUT": "64225",
    "BLUESTARCO31JUL25FUT": "64233",
    "FORTIS31JUL25FUT": "64412",
    "MANKIND31JUL25FUT": "64901",
    "CRUDEOIL21JUL25FUT": "447552",
    "ZINCMINI31JUL25FUT": "450653",
    "ZINC31JUL25FUT": "450652",
    "COPPER31JUL25FUT": "450647",
    "MCXMETLDEX24JUL25FUT": "454805",
    "SILVER04JUL25FUT": "436580",
    "NATURALGAS28JUL25FUT": "447849",
    "MENTHAOIL31JUL25FUT": "448164",
    "ALUMINI31JUL25FUT": "450645",
    "ALUMINIUM31JUL25FUT": "450646",
    "LEAD31JUL25FUT": "450648",
    "COTTONCNDY31JUL25FUT": "446483",
    "LEADMINI31JUL25FUT": "450649",
    "NICKEL31JUL25FUT": "450650",
    "STEELREBAR31JUL25FUT": "450651",
    "GOLDM04JUL25FUT": "453231",
    "MCXBULLDEX25JUL25FUT": "455857",
    "GOLDTEN31JUL25FUT": "456968",
    "COTTONOIL31JUL25FUT": "452856",
    "GOLDPETAL31JUL25FUT": "452858",
    "NATGASMINI28JUL25FUT": "447850",
    "GOLDGUINEA31JUL25FUT": "452857",
            "THIS IS LAST >>>>>>REFRESH__AGAIN>>>>>> CRUDEOILM21JUL25FUT": "447553"
        };

        async function fetchCandleDataSequential(tokens) {
            for (let token of tokens) {
                const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token).replace(/-EQ$/, '');
                try {
                    const response = await fetch(`/get_fut_data/${token}/${tokenName}`);
                    const data = await response.json();
                    displayData(token, data);
                } catch (error) {
                    console.error(`Error fetching data for token ${token}:`, error);
                }
            }
        }

        function displayData(token, data) {
            const dataContainer = document.getElementById('dataContainer');

            const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token);
            const today_len = data.data.length - 1;
            const yesterday_len = data.data.length - 2;
            const todayHigh = parseFloat(data.data[today_len]['2']);
            const todayLow = parseFloat(data.data[today_len]['3']);
            const yesterdayHigh = parseFloat(data.data[yesterday_len]['2']);
            const yesterdayLow = parseFloat(data.data[yesterday_len]['3']);
            const todayVol = parseFloat(data.data[today_len]['5']);
            const yesterdayVol = parseFloat(data.data[yesterday_len]['5']);

            const div = document.createElement('div');
            div.innerHTML = ` <br> <p class='share' > <b>${tokenName}:</b> ${JSON.stringify(data.data[today_len]['4'])}</p>
            <p class='share' > <b>Today:</b>  High: ${todayHigh} -- Low: ${todayLow} -- Volume: ${todayVol} </p>
            <p class='share' > <b>Yesterday:</b>  High: ${yesterdayHigh} -- Low: ${yesterdayLow} -- Volume: ${yesterdayVol} </p>
            <hr>`;



            if (todayHigh > yesterdayHigh && todayLow < yesterdayLow) {
                div.style.color = 'green';
                div.style.backgroundColor = 'chartreuse';
            } else {
                div.style.color = 'black';
            }


            if (dataContainer.firstChild) {
                dataContainer.insertBefore(div, dataContainer.firstChild);
            } else {
                dataContainer.appendChild(div);
            }
        }

        const tokens = Object.values(symbol_token_dict);
        console.log(tokens)

        fetchCandleDataSequential(tokens);

        function refreshData() {
            const dataContainer = document.getElementById('dataContainer');
            dataContainer.innerHTML = '';
            fetchCandleDataSequential(tokens);
        }
        document.getElementById('refreshButton').addEventListener('click', refreshData);
    </script>

</body>

</html>
