<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradeFi</title>
    <style>
        .share {
            text-align: center;
        }
    </style>
</head>

<body>
    <button style="text-align: center; padding: 2%; background-color: aqua;" id="refreshButton">Refresh</button>
    <button style="text-align: center; padding: 2%; background-color: aqua;"><a
            style="text-decoration: none; color: black;" href="/">Stocks</a></button>
            <button style="text-align: center; padding: 2%; background-color: aqua;" ><a style="text-decoration: none; color: black;" href="/backtest">Back Test</a></button>
    <div id="dataContainer"></div>


    <script>
        const symbol_token_dict = {
      "WAAREEENER24FEB26FUT": "52072",
    "ABB24FEB26FUT": "59189",
    "AUBANK24FEB26FUT": "59213",
    "BSE24FEB26FUT": "59277",
    "CONCOR24FEB26FUT": "59293",
    "CUMMINSIND24FEB26FUT": "59301",
    "HINDALCO24FEB26FUT": "59348",
    "HINDPETRO24FEB26FUT": "59349",
    "HINDZINC24FEB26FUT": "59351",
    "INDIANB24FEB26FUT": "59360",
    "ITC24FEB26FUT": "59383",
    "JINDALSTEL24FEB26FUT": "59388",
    "KPITTECH24FEB26FUT": "59398",
    "LAURUSLABS24FEB26FUT": "59399",
    "LODHA24FEB26FUT": "59402",
    "MARICO24FEB26FUT": "59418",
    "MAXHEALTH24FEB26FUT": "59420",
    "NBCC24FEB26FUT": "59429",
    "PATANJALI24FEB26FUT": "59441",
    "PIIND24FEB26FUT": "59449",
    "RBLBANK24FEB26FUT": "59458",
    "RVNL24FEB26FUT": "59461",
    "SUNPHARMA24FEB26FUT": "59473",
    "UNITDSPR24FEB26FUT": "59500",
    "VEDL24FEB26FUT": "59517",
    "ADANIENT24FEB26FUT": "59194",
    "ADANIPORTS24FEB26FUT": "59202",
    "ALKEM24FEB26FUT": "59203",
    "AMBER24FEB26FUT": "59204",
    "ASIANPAINT24FEB26FUT": "59210",
    "AXISBANK24FEB26FUT": "59215",
    "BANKBARODA24FEB26FUT": "59257",
    "BEL24FEB26FUT": "59260",
    "BOSCHLTD24FEB26FUT": "59270",
    "CGPOWER24FEB26FUT": "59287",
    "COLPAL24FEB26FUT": "59292",
    "EICHERMOT24FEB26FUT": "59310",
    "ETERNAL24FEB26FUT": "59311",
    "GODREJCP24FEB26FUT": "59338",
    "HDFCLIFE24FEB26FUT": "59346",
    "ICICIPRULI24FEB26FUT": "59355",
    "IDEA24FEB26FUT": "59356",
    "INDHOTEL24FEB26FUT": "59359",
    "INDUSTOWER24FEB26FUT": "59374",
    "KFINTECH24FEB26FUT": "59396",
    "LTIM24FEB26FUT": "59413",
    "MFSL24FEB26FUT": "59423",
    "NMDC24FEB26FUT": "59432",
    "PAGEIND24FEB26FUT": "59440",
    "SAIL24FEB26FUT": "59462",
    "SAMMAANCAP24FEB26FUT": "59463",
    "TATASTEEL24FEB26FUT": "59484",
    "WIPRO24FEB26FUT": "59519",
    "AMBUJACEM24FEB26FUT": "59205",
    "BAJAJ-AUTO24FEB26FUT": "59216",
    "BLUESTARCO24FEB26FUT": "59269",
    "COFORGE24FEB26FUT": "59291",
    "DALBHARAT24FEB26FUT": "59303",
    "FEDERALBNK24FEB26FUT": "59315",
    "INDUSINDBK24FEB26FUT": "59373",
    "LICHSGFIN24FEB26FUT": "59400",
    "LT24FEB26FUT": "59403",
    "MANKIND24FEB26FUT": "59417",
    "OBEROIRLTY24FEB26FUT": "59436",
    "OFSS24FEB26FUT": "59437",
    "POLYCAB24FEB26FUT": "59453",
    "PPLPHARMA24FEB26FUT": "59456",
    "SIEMENS24FEB26FUT": "59469",
    "SOLARINDS24FEB26FUT": "59470",
    "SYNGENE24FEB26FUT": "59476",
    "TATAELXSI24FEB26FUT": "59482",
    "TVSMOTOR24FEB26FUT": "59497",
    "UNIONBANK24FEB26FUT": "59499",
    "ZYDUSLIFE24FEB26FUT": "59521",
    "NIFTYNXT5024FEB26FUT": "59187",
    "ADANIENSOL24FEB26FUT": "59193",
    "ANGELONE24FEB26FUT": "59206",
    "ASTRAL24FEB26FUT": "59211",
    "BAJFINANCE24FEB26FUT": "59255",
    "BANDHANBNK24FEB26FUT": "59256",
    "BHARTIARTL24FEB26FUT": "59264",
    "CANBK24FEB26FUT": "59283",
    "DLF24FEB26FUT": "59307",
    "FORTIS24FEB26FUT": "59316",
    "GAIL24FEB26FUT": "59321",
    "GRASIM24FEB26FUT": "59340",
    "HAL24FEB26FUT": "59341",
    "HCLTECH24FEB26FUT": "59343",
    "HINDUNILVR24FEB26FUT": "59350",
    "ICICIBANK24FEB26FUT": "59353",
    "IEX24FEB26FUT": "59358",
    "IREDA24FEB26FUT": "59381",
    "KEI24FEB26FUT": "59395",
    "KOTAKBANK24FEB26FUT": "59397",
    "MAZDOCK24FEB26FUT": "59421",
    "NATIONALUM24FEB26FUT": "59427",
    "NYKAA24FEB26FUT": "59435",
    "POWERINDIA24FEB26FUT": "59455",
    "RECLTD24FEB26FUT": "59459",
    "TCS24FEB26FUT": "59489",
    "TMPV24FEB26FUT": "59493",
    "APLAPOLLO24FEB26FUT": "59207",
    "AUROPHARMA24FEB26FUT": "59214",
    "BANKINDIA24FEB26FUT": "59258",
    "BDL24FEB26FUT": "59259",
    "DIXON24FEB26FUT": "59306",
    "DRREDDY24FEB26FUT": "59309",
    "GODREJPROP24FEB26FUT": "59339",
    "IDFCFIRSTB24FEB26FUT": "59357",
    "INOXWIND24FEB26FUT": "59378",
    "JSWSTEEL24FEB26FUT": "59391",
    "LUPIN24FEB26FUT": "59414",
    "SHREECEM24FEB26FUT": "59467",
    "MANAPPURAM24FEB26FUT": "59416",
    "MPHASIS24FEB26FUT": "59425",
    "PETRONET24FEB26FUT": "59444",
    "SUZLON24FEB26FUT": "59475",
    "UPL24FEB26FUT": "59502",
    "VOLTAS24FEB26FUT": "59518",
    "SWIGGY24FEB26FUT": "52045",
    "MIDCPNIFTY24FEB26FUT": "59181",
    "NIFTY24FEB26FUT": "59182",
    "ABCAPITAL24FEB26FUT": "59190",
    "BHARATFORG24FEB26FUT": "59263",
    "CDSL24FEB26FUT": "59284",
    "CHOLAFIN24FEB26FUT": "59288",
    "COALINDIA24FEB26FUT": "59290",
    "CROMPTON24FEB26FUT": "59294",
    "DABUR24FEB26FUT": "59302",
    "DELHIVERY24FEB26FUT": "59304",
    "DMART24FEB26FUT": "59308",
    "HAVELLS24FEB26FUT": "59342",
    "ICICIGI24FEB26FUT": "59354",
    "JIOFIN24FEB26FUT": "59389",
    "NAUKRI24FEB26FUT": "59428",
    "NESTLEIND24FEB26FUT": "59430",
    "PGEL24FEB26FUT": "59446",
    "PIDILITIND24FEB26FUT": "59448",
    "RELIANCE24FEB26FUT": "59460",
    "SBILIFE24FEB26FUT": "59465",
    "SRF24FEB26FUT": "59472",
    "TATATECH24FEB26FUT": "59486",
    "TECHM24FEB26FUT": "59490",
    "UNOMINDA24FEB26FUT": "59501",
    "YESBANK24FEB26FUT": "59520",
    "PREMIERENE24FEB26FUT": "52017",
    "360ONE24FEB26FUT": "59188",
    "APOLLOHOSP24FEB26FUT": "59208",
    "ASHOKLEY24FEB26FUT": "59209",
    "BAJAJFINSV24FEB26FUT": "59254",
    "BPCL24FEB26FUT": "59275",
    "CIPLA24FEB26FUT": "59289",
    "DIVISLAB24FEB26FUT": "59305",
    "EXIDEIND24FEB26FUT": "59312",
    "GLENMARK24FEB26FUT": "59322",
    "IRCTC24FEB26FUT": "59380",
    "KALYANKJIL24FEB26FUT": "59393",
    "MCX24FEB26FUT": "59422",
    "MOTHERSON24FEB26FUT": "59424",
    "MUTHOOTFIN24FEB26FUT": "59426",
    "NHPC24FEB26FUT": "59431",
    "PFC24FEB26FUT": "59445",
    "PNB24FEB26FUT": "59450",
    "PNBHOUSING24FEB26FUT": "59451",
    "POLICYBZR24FEB26FUT": "59452",
    "POWERGRID24FEB26FUT": "59454",
    "SUPREMEIND24FEB26FUT": "59474",
    "TATACONSUM24FEB26FUT": "59481",
    "TORNTPOWER24FEB26FUT": "59495",
    "TRENT24FEB26FUT": "59496",
    "ULTRACEMCO24FEB26FUT": "59498",
    "VBL24FEB26FUT": "59503",
    "BHEL24FEB26FUT": "59267",
    "BRITANNIA24FEB26FUT": "59276",
    "CAMS24FEB26FUT": "59278",
    "HDFCBANK24FEB26FUT": "59345",
    "HUDCO24FEB26FUT": "59352",
    "INFY24FEB26FUT": "59375",
    "IRFC24FEB26FUT": "59382",
    "KAYNES24FEB26FUT": "59394",
    "LTF24FEB26FUT": "59404",
    "M&M24FEB26FUT": "59415",
    "MARUTI24FEB26FUT": "59419",
    "NTPC24FEB26FUT": "59433",
    "NUVAMA24FEB26FUT": "59434",
    "OIL24FEB26FUT": "59438",
    "PAYTM24FEB26FUT": "59442",
    "PERSISTENT24FEB26FUT": "59443",
    "TITAN24FEB26FUT": "59492",
    "TORNTPHARM24FEB26FUT": "59494",
    "BAJAJHLDNG24FEB26FUT": "51817",
    "BANKNIFTY24FEB26FUT": "59175",
    "FINNIFTY24FEB26FUT": "59176",
    "ADANIGREEN24FEB26FUT": "59201",
    "BIOCON24FEB26FUT": "59268",
    "GMRAIRPORT24FEB26FUT": "59335",
    "HDFCAMC24FEB26FUT": "59344",
    "HEROMOTOCO24FEB26FUT": "59347",
    "INDIGO24FEB26FUT": "59372",
    "IOC24FEB26FUT": "59379",
    "JSWENERGY24FEB26FUT": "59390",
    "JUBLFOOD24FEB26FUT": "59392",
    "LICI24FEB26FUT": "59401",
    "ONGC24FEB26FUT": "59439",
    "PHOENIXLTD24FEB26FUT": "59447",
    "PRESTIGE24FEB26FUT": "59457",
    "SBICARD24FEB26FUT": "59464",
    "SBIN24FEB26FUT": "59466",
    "SHRIRAMFIN24FEB26FUT": "59468",
    "SONACOMS24FEB26FUT": "59471",
    "TATAPOWER24FEB26FUT": "59483",
    "TIINDIA24FEB26FUT": "59491",
    "COTTONOIL27FEB26FUT": "487668",
    "SILVERM27FEB26FUT": "451669",
    "COTTON27FEB26FUT": "466031",
    "CRUDEOIL19FEB26FUT": "467013",
    "NATGASMINI24FEB26FUT": "467386",
    "KAPAS27FEB26FUT": "448166",
    "GOLD05FEB26FUT": "449534",
    "SILVERMIC27FEB26FUT": "458305",
    "CRUDEOILM19FEB26FUT": "467014",
    "GOLDPETAL27FEB26FUT": "472788",
    "COPPER27FEB26FUT": "477167",
    "ZINC27FEB26FUT": "477171",
    "GOLDTEN27FEB26FUT": "472784",
    "LEADMINI27FEB26FUT": "477169",
    "CARDAMOM27FEB26FUT": "477183",
    "NATURALGAS24FEB26FUT": "467385",
    "MENTHAOIL27FEB26FUT": "467750",
    "LEAD27FEB26FUT": "477168",
    "ZINCMINI27FEB26FUT": "477172",
    "NICKEL18FEB26FUT": "477173",
    "GOLDM05FEB26FUT": "472780",
    "GOLDGUINEA27FEB26FUT": "472786",
    "ALUMINIUM27FEB26FUT": "477166",
    "STEELREBAR27FEB26FUT": "477170",
    "ALUMINI27FEB26FUT": "477165",
    "ELECDMBL27FEB26FUT": "487675",
    "MCXBULLDEX24FEB26FUT": "488289",
            "THIS IS LAST >>>>>>REFRESH__AGAIN>>>>>> MCXMETLDEX20FEB26FUT": "488282"
        };

        async function fetchCandleDataSequential(tokens) {
            for (let token of tokens) {
                const tokenName = Object.keys(symbol_token_dict).find(key  => symbol_token_dict[key] === token).replace(/-EQ$/, '');
                try {
                    const response = await fetch(`/get_fut_data/${token}/${tokenName}`);
                    const data = await response.json();
                    displayData(token, data);
                } catch (error) {
                    console.error(`Error fetching data for token ${token}:`, error);
                }
            }
        }

        function displayData(token, data) {
            const dataContainer = document.getElementById('dataContainer');

            const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token);
            const today_len = data.data.length - 1;
            const yesterday_len = data.data.length - 2;
            const todayHigh = parseFloat(data.data[today_len]['2']);
            const todayLow = parseFloat(data.data[today_len]['3']);
            const yesterdayHigh = parseFloat(data.data[yesterday_len]['2']);
            const yesterdayLow = parseFloat(data.data[yesterday_len]['3']);
            const todayVol = parseFloat(data.data[today_len]['5']);
            const yesterdayVol = parseFloat(data.data[yesterday_len]['5']);

            const div = document.createElement('div');
            div.innerHTML = ` <br> <p class='share' > <b>${tokenName}:</b> ${JSON.stringify(data.data[today_len]['4'])}</p>
            <p class='share' > <b>Today:</b>  High: ${todayHigh} -- Low: ${todayLow} -- Volume: ${todayVol} </p>
            <p class='share' > <b>Yesterday:</b>  High: ${yesterdayHigh} -- Low: ${yesterdayLow} -- Volume: ${yesterdayVol} </p>
            <hr>`;



            if (todayHigh > yesterdayHigh && todayLow < yesterdayLow) {
                div.style.color = 'green';
                div.style.backgroundColor = 'chartreuse';
            } else {
                div.style.color = 'black';
            }


            if (dataContainer.firstChild) {
                dataContainer.insertBefore(div, dataContainer.firstChild);
            } else {
                dataContainer.appendChild(div);
            }
        }

        const tokens = Object.values(symbol_token_dict);
        console.log(tokens)

        fetchCandleDataSequential(tokens);

        function refreshData() {
            const dataContainer = document.getElementById('dataContainer');
            dataContainer.innerHTML = '';
            fetchCandleDataSequential(tokens);
        }
        document.getElementById('refreshButton').addEventListener('click', refreshData);
    </script>

</body>

</html>
