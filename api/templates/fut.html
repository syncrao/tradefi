<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradeFi</title>
    <style>
        .share {
            text-align: center;
        }
    </style>
</head>

<body>
    <button style="text-align: center; padding: 2%; background-color: aqua;" id="refreshButton">Refresh</button>
    <button style="text-align: center; padding: 2%; background-color: aqua;"><a
            style="text-decoration: none; color: black;" href="/">Stocks</a></button>
            <button style="text-align: center; padding: 2%; background-color: aqua;" ><a style="text-decoration: none; color: black;" href="/backtest">Back Test</a></button>
    <div id="dataContainer"></div>


    <script>
        const symbol_token_dict = {
"ADANIENSOL26JUN25FUT": "56798",
    "ADANIENT26JUN25FUT": "56799",
    "BANDHANBNK26JUN25FUT": "56830",
    "ASTRAL26JUN25FUT": "56817",
    "ASHOKLEY26JUN25FUT": "56811",
    "BHARATFORG26JUN25FUT": "56834",
    "BOSCHLTD26JUN25FUT": "56844",
    "CONCOR26JUN25FUT": "56862",
    "GODREJPROP26JUN25FUT": "56929",
    "HFCL26JUN25FUT": "56953",
    "ICICIGI26JUN25FUT": "56969",
    "INOXWIND26JUN25FUT": "57002",
    "LT26JUN25FUT": "57043",
    "MANAPPURAM26JUN25FUT": "57053",
    "M&M26JUN25FUT": "57051",
    "NAUKRI26JUN25FUT": "57064",
    "OIL26JUN25FUT": "57074",
    "OBEROIRLTY26JUN25FUT": "57072",
    "PIDILITIND26JUN25FUT": "57086",
    "PEL26JUN25FUT": "57081",
    "PRESTIGE26JUN25FUT": "57100",
    "SUNPHARMA26JUN25FUT": "57129",
    "BAJAJ-AUTO26JUN25FUT": "56826",
    "BPCL26JUN25FUT": "56845",
    "CAMS26JUN25FUT": "56849",
    "INDHOTEL26JUN25FUT": "56988",
    "INFY26JUN25FUT": "56995",
    "KOTAKBANK26JUN25FUT": "57033",
    "IRCTC26JUN25FUT": "57005",
    "LODHA26JUN25FUT": "57042",
    "LUPIN26JUN25FUT": "57050",
    "MAXHEALTH26JUN25FUT": "57056",
    "MCX26JUN25FUT": "57057",
    "MFSL26JUN25FUT": "57058",
    "NCC26JUN25FUT": "57066",
    "NMDC26JUN25FUT": "57069",
    "PAGEIND26JUN25FUT": "57077",
    "PNB26JUN25FUT": "57088",
    "POLYCAB26JUN25FUT": "57093",
    "TATATECH26JUN25FUT": "57249",
    "NIFTYNXT5026JUN25FUT": "56786",
    "ASIANPAINT26JUN25FUT": "56816",
    "BANKBARODA26JUN25FUT": "56831",
    "BAJAJFINSV26JUN25FUT": "56827",
    "BSOFT26JUN25FUT": "56848",
    "CIPLA26JUN25FUT": "56858",
    "CUMMINSIND26JUN25FUT": "56864",
    "DIVISLAB26JUN25FUT": "56905",
    "DABUR26JUN25FUT": "56900",
    "FEDERALBNK26JUN25FUT": "56918",
    "GAIL26JUN25FUT": "56919",
    "GMRAIRPORT26JUN25FUT": "56927",
    "HDFCBANK26JUN25FUT": "56946",
    "IGL26JUN25FUT": "56986",
    "INDUSINDBK26JUN25FUT": "56991",
    "JUBLFOOD26JUN25FUT": "57026",
    "JIOFIN26JUN25FUT": "57020",
    "KPITTECH26JUN25FUT": "57034",
    "LICHSGFIN26JUN25FUT": "57038",
    "PNBHOUSING26JUN25FUT": "57091",
    "SAIL26JUN25FUT": "57110",
    "SIEMENS26JUN25FUT": "57120",
    "TATAMOTORS26JUN25FUT": "57238",
    "TORNTPOWER26JUN25FUT": "57256",
    "APLAPOLLO26JUN25FUT": "56809",
    "AUROPHARMA26JUN25FUT": "56822",
    "BALKRISIND26JUN25FUT": "56829",
    "CROMPTON26JUN25FUT": "56863",
    "DMART26JUN25FUT": "56908",
    "EXIDEIND26JUN25FUT": "56911",
    "HINDZINC26JUN25FUT": "56966",
    "IDEA26JUN25FUT": "56971",
    "IDFCFIRSTB26JUN25FUT": "56972",
    "IOC26JUN25FUT": "57003",
    "JINDALSTEL26JUN25FUT": "57013",
    "JSWENERGY26JUN25FUT": "57024",
    "JSL26JUN25FUT": "57021",
    "NBCC26JUN25FUT": "57065",
    "NESTLEIND26JUN25FUT": "57067",
    "RBLBANK26JUN25FUT": "57101",
    "TATAPOWER26JUN25FUT": "57239",
    "SUPREMEIND26JUN25FUT": "57200",
    "TATACONSUM26JUN25FUT": "57224",
    "TVSMOTOR26JUN25FUT": "57258",
    "TECHM26JUN25FUT": "57251",
    "TATACOMM26JUN25FUT": "57223",
    "TATAELXSI26JUN25FUT": "57225",
    "TIINDIA26JUN25FUT": "57252",
    "TORNTPHARM26JUN25FUT": "57255",
    "VBL26JUN25FUT": "57273",
    "YESBANK26JUN25FUT": "57277",
    "VEDL26JUN25FUT": "57274",
    "WIPRO26JUN25FUT": "57276",
    "PPLPHARMA26JUN25FUT": "64987",
    "RVNL26JUN25FUT": "64996",
    "FINNIFTY26JUN25FUT": "56783",
    "MIDCPNIFTY26JUN25FUT": "56784",
    "AARTIIND26JUN25FUT": "56787",
    "ATGL26JUN25FUT": "56818",
    "AUBANK26JUN25FUT": "56819",
    "BEL26JUN25FUT": "56833",
    "BHEL26JUN25FUT": "56838",
    "BSE26JUN25FUT": "56847",
    "CHOLAFIN26JUN25FUT": "56857",
    "CANBK26JUN25FUT": "56850",
    "HDFCLIFE26JUN25FUT": "56947",
    "DELHIVERY26JUN25FUT": "56904",
    "DRREDDY26JUN25FUT": "56909",
    "HINDCOPPER26JUN25FUT": "56955",
    "HINDUNILVR26JUN25FUT": "56957",
    "HUDCO26JUN25FUT": "56967",
    "MARUTI26JUN25FUT": "57055",
    "NATIONALUM26JUN25FUT": "57063",
    "NHPC26JUN25FUT": "57068",
    "MUTHOOTFIN26JUN25FUT": "57062",
    "RECLTD26JUN25FUT": "57104",
    "UNITDSPR26JUN25FUT": "57263",
    "BLUESTARCO26JUN25FUT": "64232",
    "MANKIND26JUN25FUT": "64898",
    "ABB26JUN25FUT": "56788",
    "ADANIGREEN26JUN25FUT": "56800",
    "ANGELONE26JUN25FUT": "56808",
    "APOLLOHOSP26JUN25FUT": "56810",
    "BAJFINANCE26JUN25FUT": "56828",
    "EICHERMOT26JUN25FUT": "56910",
    "HINDALCO26JUN25FUT": "56954",
    "ICICIBANK26JUN25FUT": "56968",
    "IIFL26JUN25FUT": "56987",
    "INDIANB26JUN25FUT": "56989",
    "INDIGO26JUN25FUT": "56990",
    "INDUSTOWER26JUN25FUT": "56994",
    "IREDA26JUN25FUT": "57010",
    "LTF26JUN25FUT": "57048",
    "M&MFIN26JUN25FUT": "57052",
    "NTPC26JUN25FUT": "57070",
    "PATANJALI26JUN25FUT": "57079",
    "PFC26JUN25FUT": "57084",
    "PAYTM26JUN25FUT": "57080",
    "PERSISTENT26JUN25FUT": "57082",
    "POONAWALLA26JUN25FUT": "57094",
    "RELIANCE26JUN25FUT": "57105",
    "SBILIFE26JUN25FUT": "57112",
    "SHRIRAMFIN26JUN25FUT": "57115",
    "ACC26JUN25FUT": "56795",
    "AMBUJACEM26JUN25FUT": "56807",
    "BHARTIARTL26JUN25FUT": "56835",
    "CGPOWER26JUN25FUT": "56853",
    "CESC26JUN25FUT": "56852",
    "DIXON26JUN25FUT": "56906",
    "HAL26JUN25FUT": "56932",
    "HCLTECH26JUN25FUT": "56940",
    "IRFC26JUN25FUT": "57011",
    "JSWSTEEL26JUN25FUT": "57025",
    "KEI26JUN25FUT": "57032",
    "KALYANKJIL26JUN25FUT": "57027",
    "MPHASIS26JUN25FUT": "57061",
    "ONGC26JUN25FUT": "57075",
    "PETRONET26JUN25FUT": "57083",
    "SBICARD26JUN25FUT": "57111",
    "SBIN26JUN25FUT": "57113",
    "SHREECEM26JUN25FUT": "57114",
    "SONACOMS26JUN25FUT": "57123",
    "SOLARINDS26JUN25FUT": "57122",
    "ABCAPITAL26JUN25FUT": "56789",
    "BANKINDIA26JUN25FUT": "56832",
    "ALKEM26JUN25FUT": "56806",
    "AXISBANK26JUN25FUT": "56823",
    "COFORGE26JUN25FUT": "56860",
    "DLF26JUN25FUT": "56907",
    "HDFCAMC26JUN25FUT": "56941",
    "GLENMARK26JUN25FUT": "56926",
    "HINDPETRO26JUN25FUT": "56956",
    "HEROMOTOCO26JUN25FUT": "56952",
    "IEX26JUN25FUT": "56973",
    "IRB26JUN25FUT": "57004",
    "ITC26JUN25FUT": "57012",
    "LAURUSLABS26JUN25FUT": "57035",
    "LICI26JUN25FUT": "57039",
    "POWERGRID26JUN25FUT": "57095",
    "POLICYBZR26JUN25FUT": "57092",
    "SRF26JUN25FUT": "57128",
    "SJVN26JUN25FUT": "57121",
    "BANKNIFTY26JUN25FUT": "56782",
    "NIFTY26JUN25FUT": "56785",
    "ABFRL26JUN25FUT": "56794",
    "ADANIPORTS26JUN25FUT": "56801",
    "BIOCON26JUN25FUT": "56839",
    "BRITANNIA26JUN25FUT": "56846",
    "CHAMBLFERT26JUN25FUT": "56856",
    "CDSL26JUN25FUT": "56851",
    "COALINDIA26JUN25FUT": "56859",
    "CYIENT26JUN25FUT": "56865",
    "COLPAL26JUN25FUT": "56861",
    "DALBHARAT26JUN25FUT": "56901",
    "GRANULES26JUN25FUT": "56930",
    "GODREJCP26JUN25FUT": "56928",
    "HAVELLS26JUN25FUT": "56933",
    "GRASIM26JUN25FUT": "56931",
    "ICICIPRULI26JUN25FUT": "56970",
    "LTIM26JUN25FUT": "57049",
    "MARICO26JUN25FUT": "57054",
    "MGL26JUN25FUT": "57059",
    "MOTHERSON26JUN25FUT": "57060",
    "OFSS26JUN25FUT": "57073",
    "NYKAA26JUN25FUT": "57071",
    "PHOENIXLTD26JUN25FUT": "57085",
    "PIIND26JUN25FUT": "57087",
    "SYNGENE26JUN25FUT": "57201",
    "TATASTEEL26JUN25FUT": "57248",
    "TITAGARH26JUN25FUT": "57253",
    "TCS26JUN25FUT": "57250",
    "UNIONBANK26JUN25FUT": "57262",
    "ZYDUSLIFE26JUN25FUT": "57283",
    "KAYNES26JUN25FUT": "64623",
    "TATACHEM26JUN25FUT": "57222",
    "ETERNAL26JUN25FUT": "57278",
    "MAZDOCK26JUN25FUT": "64906",
    "TITAN26JUN25FUT": "57254",
    "TRENT26JUN25FUT": "57257",
    "ULTRACEMCO26JUN25FUT": "57261",
    "UPL26JUN25FUT": "57264",
    "VOLTAS26JUN25FUT": "57275",
    "BDL26JUN25FUT": "64224",
    "UNOMINDA26JUN25FUT": "65236",
    "FORTIS26JUN25FUT": "64411",
    "ZINC30JUN25FUT": "448161",
    "MENTHAOIL30JUN25FUT": "446485",
    "COTTONOIL30JUN25FUT": "450655",
    "GOLDGUINEA30JUN25FUT": "450657",
    "GOLD05JUN25FUT": "435697",
    "SILVERM30JUN25FUT": "436581",
    "MCXMETLDEX23JUN25FUT": "451665",
    "MCXBULLDEX25JUN25FUT": "452368",
    "GOLDTEN30JUN25FUT": "452777",
    "COPPER30JUN25FUT": "448155",
    "ALUMINI30JUN25FUT": "448153",
    "ALUMINIUM30JUN25FUT": "448154",
    "STEELREBAR30JUN25FUT": "448159",
    "SILVERMIC30JUN25FUT": "440576",
    "NATURALGAS25JUN25FUT": "446265",
    "CRUDEOIL18JUN25FUT": "445825",
    "NATGASMINI25JUN25FUT": "446266",
    "LEADMINI30JUN25FUT": "448156",
    "LEAD30JUN25FUT": "448157",
    "GOLDM05JUN25FUT": "450845",
    "CRUDEOILM18JUN25FUT": "445826",
    "NICKEL30JUN25FUT": "448158",
    "ZINCMINI30JUN25FUT": "448160",

            "THIS IS LAST >>>>>>REFRESH__AGAIN>>>>>> GOLDPETAL30JUN25FUT": "450658"
        };

        async function fetchCandleDataSequential(tokens) {
            for (let token of tokens) {
                const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token).replace(/-EQ$/, '');
                try {
                    const response = await fetch(`/get_fut_data/${token}/${tokenName}`);
                    const data = await response.json();
                    displayData(token, data);
                } catch (error) {
                    console.error(`Error fetching data for token ${token}:`, error);
                }
            }
        }

        function displayData(token, data) {
            const dataContainer = document.getElementById('dataContainer');

            const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token);
            const today_len = data.data.length - 1;
            const yesterday_len = data.data.length - 2;
            const todayHigh = parseFloat(data.data[today_len]['2']);
            const todayLow = parseFloat(data.data[today_len]['3']);
            const yesterdayHigh = parseFloat(data.data[yesterday_len]['2']);
            const yesterdayLow = parseFloat(data.data[yesterday_len]['3']);
            const todayVol = parseFloat(data.data[today_len]['5']);
            const yesterdayVol = parseFloat(data.data[yesterday_len]['5']);

            const div = document.createElement('div');
            div.innerHTML = ` <br> <p class='share' > <b>${tokenName}:</b> ${JSON.stringify(data.data[today_len]['4'])}</p>
            <p class='share' > <b>Today:</b>  High: ${todayHigh} -- Low: ${todayLow} -- Volume: ${todayVol} </p>
            <p class='share' > <b>Yesterday:</b>  High: ${yesterdayHigh} -- Low: ${yesterdayLow} -- Volume: ${yesterdayVol} </p>
            <hr>`;



            if (todayHigh > yesterdayHigh && todayLow < yesterdayLow) {
                div.style.color = 'green';
                div.style.backgroundColor = 'chartreuse';
            } else {
                div.style.color = 'black';
            }


            if (dataContainer.firstChild) {
                dataContainer.insertBefore(div, dataContainer.firstChild);
            } else {
                dataContainer.appendChild(div);
            }
        }

        const tokens = Object.values(symbol_token_dict);
        console.log(tokens)

        fetchCandleDataSequential(tokens);

        function refreshData() {
            const dataContainer = document.getElementById('dataContainer');
            dataContainer.innerHTML = '';
            fetchCandleDataSequential(tokens);
        }
        document.getElementById('refreshButton').addEventListener('click', refreshData);
    </script>

</body>

</html>
